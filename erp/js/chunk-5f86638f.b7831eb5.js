(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f86638f"],{"01b7":function(t,e,i){"use strict";var n=i("e4f8"),a=i.n(n);a.a},1974:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Row",{staticClass:"P-Inline-Block"},[i("Col",[i("Button",{staticClass:"P-Inline-Block P-MR-10",attrs:{type:"primary"},on:{click:function(e){return t.OpenModal()}}},[t._v("批量质检")]),i("Modal",{staticClass:"Container-Tabs",attrs:{title:"批量质检","mask-closable":!1,width:1100},on:{"on-cancel":function(e){return t.ClearModal(0)}},model:{value:t.ModifyModal,callback:function(e){t.ModifyModal=e},expression:"ModifyModal"}},[i("Row",[t.SelecData.length<1?i("Form",{ref:"BatchQualityTestingForm",attrs:{"label-width":150,model:t.BatchQualityTestingForm,rules:t.BatchQualityTestingRule,inline:"",onsubmit:"return false"}},[i("FormItem",{staticClass:"P-W-100-Percent P-MB-10",attrs:{label:"到货单号/采购单号：",prop:"Code"}},[i("Input",{ref:"BatchQualityTestingCode",attrs:{placeholder:"到货单号/采购单号"},on:{"on-enter":function(e){return t.CheckQAList(!1)}},model:{value:t.BatchQualityTestingForm.Code,callback:function(e){t.$set(t.BatchQualityTestingForm,"Code","string"===typeof e?e.trim():e)},expression:"BatchQualityTestingForm.Code"}}),i("p",{staticClass:"Color-Gray"},[t._v("请扫描/输入到货单号或快递单号，输入完成后请按回车键。")])],1)],1):t._e(),i("Col",[t.IsShowFilterTips?i("p",{staticClass:"Color-Red P-MB-10"},[t._v("已为您筛选出状态处于待质检的到货单：")]):t._e(),i("Table",{ref:"BatchQualityTesting",attrs:{columns:t.Cols,data:t.List,size:"small",stripe:"",height:400}})],1)],1),i("ShowBigPic",{ref:"ShowBigPic"}),i("footer",{staticClass:"P-TA-R",attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:t.PostData}},[t._v("质检")]),i("Button",{on:{click:function(e){return t.ClearModal(0)}}},[t._v("取消")])],1)],1)],1)],1)},a=[],s=(i("d9b9"),i("9660"),i("6ed5"),i("cee1"),i("6bf8"),i("0b78"),i("5c62")),o=i("3231"),r=i("064d"),l=i("46d7"),u=i("631e"),c=i("4a81"),d=i("d11d"),h=i("c638"),f=function(t){Object(l["a"])(i,t);var e=Object(u["a"])(i);function i(){var t;return Object(o["a"])(this,i),t=e.apply(this,arguments),t.SelecData=[new h["a"].Pao],t.QAImgLength=0,t.UploadList=[],t.DefaultList=[],t.UploadImgServer=t.$Server.Settings+t.$Api.UploadImage,t.ModifyModal=!1,t.SkuInfo=new h["a"].SkuInfo,t.BatchQualityTestingForm=new h["a"].SingleCodeForm,t.BatchQualityTestingRule={Code:[{required:!0,message:" "}]},t.QualityTestingCode="",t.IsShowFilterTips=!1,t.List=[],t.Cols=[{title:"到货单号",key:"OrderCode",width:150},{title:"SKU编号",key:"SkuCode",width:150},{title:"采购数量",key:"PurchaseQuantity",width:150},{title:"实到数量",render:function(e,i){return e("InputNumber",{props:{min:0,value:t.List[i.row._index].ActualQuantity},on:{"on-change":function(e){t.List[i.row._index].ActualQuantity=e}}})}},{title:"质检不通过数量",render:function(e,i){return e("InputNumber",{props:{min:0,value:t.List[i.row._index].NoPassQuantity},on:{"on-change":function(e){t.List[i.row._index].NoPassQuantity=e}}})}},{title:"备注",render:function(e,i){return e("Input",{attrs:{placeholder:"请输入备注"},on:{input:function(e){t.List[i.row._index].Remark=e}},className:"w100"})}},{title:"操作",width:80,render:function(e,i){return e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.List.splice(i.row._index,1)}}},"删除")}}],t}return Object(r["a"])(i,[{key:"HandleResMsg",value:function(t){}},{key:"Trigger",value:function(t){var e,i=this;t.some((function(t){return 2!==t.Status}))?this.$UI.Tips.Floating("warning","请选择状态为待质检的到货单进行质检操作"):(this.SelecData=JSON.parse(JSON.stringify(t)),(e=this.List).splice.apply(e,[0,this.List.length].concat(Object(s["a"])(t))),this.ModifyModal=!0,this.$nextTick((function(){i.SelecData.length<1&&i.$refs["BatchQualityTestingCode"].focus()})))}},{key:"OpenModal",value:function(){this.HandleResMsg(2)}},{key:"CheckQAList",value:function(t){var e=this;if(""!==this.BatchQualityTestingForm.Code)if(this.List.length<1)this.GetCodeInfo();else{if(this.List.some((function(t){return t.OrderCode===e.BatchQualityTestingForm.Code})))return this.$UI.Tips.Floating("warning","该到货单已存在列表中"),void this.FocusInput();this.GetCodeInfo()}}},{key:"GetCodeInfo",value:function(){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.PrintPAO,Login:!0},Data:this.BatchQualityTestingForm.Code,Callback:function(e){t.$UI.Loading.Hide(),e.IsSuccess?t.RenderQAData(e.Data.Data):t.$Request.Error(e)}})}},{key:"RenderQAData",value:function(t){var e=this;t.forEach((function(t){2!==t.Status?e.IsShowFilterTips=!0:e.List.some((function(e){return e.OrderCode===t.OrderCode}))||e.List.push(t)})),this.List.length<1&&(this.$UI.Tips.Floating("warning","扫描到货单状态不为待质检或扫描的快递单号中所有的到货单均不处于待质检状态，请重新扫描"),this.FocusInput(),this.IsShowFilterTips=!1)}},{key:"PostData",value:function(){var t=this;if(this.List.length<1)this.FocusInput();else{var e=[];this.List.forEach((function(t){var i={Id:t.Id,NoPassQuantity:t.NoPassQuantity,ActualQuantity:t.ActualQuantity,Remark:t.Remark};e.push(i)})),this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.PurchaseArrivalOrderMulitQA,Login:!0},Data:e,Callback:function(e){e.IsSuccess?(t.$UI.Tips.Floating("success","质检成功"),t.ClearModal(1)):(t.$UI.Loading.Hide(),t.$Request.Error(e))}})}}},{key:"FocusInput",value:function(){this.BatchQualityTestingForm.Code="",this.$refs.BatchQualityTestingCode.focus()}},{key:"ClearModal",value:function(t){this.$set(this,"ModifyModal",!1),this.HandleResMsg(t),this.UploadList=[],this.SkuInfo=new h["a"].SkuInfo,this.BatchQualityTestingForm.Code=""}}]),i}(d["d"]);c["a"]([Object(d["b"])()],f.prototype,"HandleResMsg",null),f=c["a"]([Object(d["a"])({name:"QuantityTestingBatch",components:{ShowBigPic:function(){return i.e("chunk-c0a1d894").then(i.bind(null,"6156"))}}})],f);var p=f,g=p,y=(i("01b7"),i("4023")),C=Object(y["a"])(g,n,a,!1,null,null,null);e["default"]=C.exports},e4f8:function(t,e,i){}}]);