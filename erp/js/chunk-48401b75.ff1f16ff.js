(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48401b75"],{"597d":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Row",{staticClass:"P-Inline-Block P-MB-10"},[r("Col",[r("Button",{staticClass:"P-MR-10",attrs:{type:"primary"},on:{click:function(t){return e.HandleResMsg(2)}}},[e._v("添加新品")]),r("Modal",{staticClass:"Container-Tabs",attrs:{title:"新品详情","mask-closable":!1,width:"1000"},on:{"on-cancel":function(t){return e.ClearModal(0)}},model:{value:e.ShowModal,callback:function(t){e.ShowModal=t},expression:"ShowModal"}},[e.ModifyStatus?r("Row",{staticClass:"P-MB-5",staticStyle:{"margin-bottom":"6px"}},[r("p",[e._v("开发日期："+e._s(e.ProductDevDetails.CreateTime.split("T")[0]))])]):e._e(),r("Row",[r("Tabs",{attrs:{name:"ProductDev",type:"card",closable:!1,value:e.ActiveTab},on:{"on-click":e.ChangeTabs}},[r("TabPane",{attrs:{label:"基本信息",name:"Base",tab:"ProductDev"}},[r("Form",{ref:"ProductDevDetails",attrs:{inline:"","label-width":100,model:e.ProductDevDetails,rules:e.ProductDevRules,onsubmit:"return false;",name:"ProductDevDetails"}},[r("Col",{staticClass:"P-MR-20",attrs:{span:"17"}},[r("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"产品名：",prop:"ProductName"}},[e.ModifyStatus?r("Input",{attrs:{placeholder:"产品名",name:"proNameInput"},model:{value:e.ProductDevDetails.ProductName,callback:function(t){e.$set(e.ProductDevDetails,"ProductName",t)},expression:"ProductDevDetails.ProductName"}}):r("span",[e._v(e._s(e.ProductDevDetails.ProductName))])],1),r("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"销售关键字：",prop:"SaleKeyWord"}},[e.ModifyStatus?r("Input",{attrs:{placeholder:"销售关键字"},model:{value:e.ProductDevDetails.SaleKeyWord,callback:function(t){e.$set(e.ProductDevDetails,"SaleKeyWord",t)},expression:"ProductDevDetails.SaleKeyWord"}}):r("span",[e._v(e._s(e.ProductDevDetails.SaleKeyWord))])],1),r("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"特性标签：",prop:"Attribute"}},[e.ModifyStatus?r("Select",{attrs:{multiple:"",placeholder:"特性标签",options:e.DropAttribute,transfer:""},model:{value:e.ProductDevDetails.Attribute,callback:function(t){e.$set(e.ProductDevDetails,"Attribute",t)},expression:"ProductDevDetails.Attribute"}}):r("span",[e._v(e._s(e.ProductDevDetails.AttributeName))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"品类：",prop:"CategoryId"}},[e.ModifyStatus?r("Cascader",{attrs:{transfer:"",data:e.Tree,"change-on-select":"",filterable:"",placeholder:"品类"},on:{"on-change":e.SetCategory},model:{value:e.ProductDevDetails.CategoryId,callback:function(t){e.$set(e.ProductDevDetails,"CategoryId",t)},expression:"ProductDevDetails.CategoryId"}}):r("span",[e._v(e._s(e.ProductDevDetails.CategoryName))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"平台：",prop:"Platfrom"}},[e.ModifyStatus?r("Select",{attrs:{placeholder:"平台",options:e.DropPlatform,transfer:""},model:{value:e.ProductDevDetails.Platfrom,callback:function(t){e.$set(e.ProductDevDetails,"Platfrom",t)},expression:"ProductDevDetails.Platfrom"}}):r("span",[e._v(e._s(e.$Enums.Sales.Platform[e.ProductDevDetails.Platfrom]))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"产品经理：",prop:"DevManager"}},[e.ModifyStatus?r("Select",{attrs:{placeholder:"产品经理",options:e.DropDevManager,transfer:""},model:{value:e.ProductDevDetails.DevManager,callback:function(t){e.$set(e.ProductDevDetails,"DevManager",t)},expression:"ProductDevDetails.DevManager"}}):r("span",[e._v(e._s(e.ProductDevDetails.DevMangerName))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"销售主管：",prop:"SaleManager"}},[e.ModifyStatus?r("Select",{attrs:{placeholder:"销售主管",options:e.DropSaleManager,transfer:""},model:{value:e.ProductDevDetails.SaleManager,callback:function(t){e.$set(e.ProductDevDetails,"SaleManager",t)},expression:"ProductDevDetails.SaleManager"}}):r("span",[e._v(e._s(e.ProductDevDetails.SaleManagerName))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"重量：",prop:"Weight"}},[e.ModifyStatus?r("InputNumber",{staticClass:"P-W-100-Percent",attrs:{min:0,placeholder:"重量"},model:{value:e.ProductDevDetails.Weight,callback:function(t){e.$set(e.ProductDevDetails,"Weight",t)},expression:"ProductDevDetails.Weight"}}):r("span",[e._v(e._s(e.ProductDevDetails.Weight))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"SKU序号：",prop:"CategoryNum"}},[e.ModifyStatus?r("Input",{attrs:{placeholder:"SKU序号"},model:{value:e.ProductDevDetails.CategoryNum,callback:function(t){e.$set(e.ProductDevDetails,"CategoryNum",t)},expression:"ProductDevDetails.CategoryNum"}}):r("span",[e._v(e._s(e.ProductDevDetails.CategoryNum))])],1),r("Form-item",{staticClass:"P-W-300",attrs:{label:"开发员：",prop:"Creator"}},[e.ModifyStatus?r("Select",{attrs:{placeholder:"请选择开发员",options:e.DropDevUser,transfer:""},model:{value:e.ProductDevDetails.Creator,callback:function(t){e.$set(e.ProductDevDetails,"Creator",t)},expression:"ProductDevDetails.Creator"}}):r("span",[e._v(e._s(e.ProductDevDetails.CreatorName))])],1)],1),r("Col",{staticClass:"P-TA-C",attrs:{span:"6"}},[""!==e.ProductDevDetails.ImageUrl?r("div",{staticClass:"demo-upload-list",staticStyle:{width:"200px",height:"200px"}},[r("img",{attrs:{src:e.$Server.File+"/"+e.ProductDevDetails.ImageUrl,height:"200",width:"200"}}),r("div",{staticClass:"demo-upload-list-cover"},[r("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(t){return e.ShowPic(e.ProductDevDetails.ImageUrl)}}}),e.ModifyStatus?r("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(t){return e.HandleRemove(t)}}}):e._e()],1)]):r("Upload",{ref:"Upload",staticStyle:{display:"inline-block",width:"100%",height:"200px"},attrs:{"show-upload-list":!1,"on-success":e.HandleSuccess,format:["jpg","jpeg","png"],"max-size":2048,"on-format-error":e.HandleFormatError,"on-exceeded-size":e.HandleMaxSize,type:"drag",action:e.UploadImgServer}},[r("div",{staticStyle:{height:"200px"}},[r("Icon",{staticStyle:{"margin-top":"55px"},attrs:{type:"camera",size:"20"}}),r("p",[e._v("上传图片")]),r("span",{staticStyle:{"padding-bottom":"12px"}},[e._v("仅支持jpg、png图片格式，大小不超过2M")])],1)])],1),r("Col",{attrs:{span:"24"}},[r("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"备注：",prop:"Remark"}},[e.ModifyStatus?r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"备注"},model:{value:e.ProductDevDetails.Remark,callback:function(t){e.$set(e.ProductDevDetails,"Remark",t)},expression:"ProductDevDetails.Remark"}}):r("span",[e._v(e._s(e.ProductDevDetails.Remark))])],1),e.IsReview?r("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"审核备注：",prop:"Remark"}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:4},placeholder:"审核备注"},model:{value:e.ReviewRemark,callback:function(t){e.ReviewRemark=t},expression:"ReviewRemark"}})],1):e._e()],1)],1)],1),r("TabPane",{attrs:{label:"供应商",name:"Supply",tab:"ProductDev"}},[r("Row",[r("Table",{attrs:{columns:e.SupplyDataCol,data:e.ProductSupplyInfo,size:"small",stripe:"",height:150}})],1),e.ModifyStatus?r("Row",{staticClass:"P-MT-10 P-TA-R"},[r("Button",{staticClass:"P-MR-5",attrs:{type:"primary"},on:{click:e.AddSupplier}},[e._v("添加供应商")]),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.AddLine("Supply")}}},[e._v("添加一行")])],1):e._e(),r("Row",{staticClass:"P-MT-10"},[r("Table",{attrs:{columns:e.ProfitDataCols,data:[e.ProfitData],size:"small",stripe:"",height:76}})],1),r("Row",{staticClass:"P-MT-10"},[r("Table",{attrs:{columns:e.MatchCols,data:e.ProductMatch,size:"small",stripe:"",height:150}})],1),e.ModifyStatus?r("Row",{staticClass:"P-MT-10 P-TA-R"},[r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.AddLine("Match")}}},[e._v("添加一行")])],1):e._e()],1),r("TabPane",{attrs:{label:"新品属性",name:"Property",tab:"ProductDev"}},[r("div",{staticClass:"Cont-Wrap"},[r("div",{staticClass:"Cont-Title"},[e._v(" 新品属性 ")]),r("div",{staticClass:"Cont-Body"},[0===e.ProductProperty.length?r("p",{staticClass:"P-TA-C"},[e._v("暂无新品属性")]):r("div",e._l(e.ProductProperty,(function(t,a){return r("Tag",{key:t.PropertyName,attrs:{type:"dot",closable:e.ModifyStatus,color:"primary"},on:{"on-close":function(t){return e.ClosePropertyTag("ProductProperty",a)}}},[e._v(e._s(t.PropertyName))])})),1),e.ModifyStatus?r("div",{staticClass:"P-MT-10"},[r("Input",{attrs:{placeholder:"新品属性"},on:{"on-enter":function(t){return e.AddPropertyTag("ProductProperty")}},model:{value:e.AddPropertyName,callback:function(t){e.AddPropertyName=t},expression:"AddPropertyName"}},[r("Button",{attrs:{slot:"append"},on:{click:function(t){return e.AddPropertyTag("ProductProperty")}},slot:"append"},[e._v("添加")])],1)],1):e._e()])]),r("div",{staticClass:"Cont-Wrap P-MT-10"},[r("div",{staticClass:"Cont-Title"},[e._v(" 属性信息 ")]),r("div",{staticClass:"Cont-Body"},[0===e.ProductProperty.length?r("p",{staticClass:"P-TA-C"},[e._v("暂无属性信息")]):r("div",[r("Form",{staticClass:"P-MT-5",attrs:{"label-width":80,onsubmit:"return false;"}},e._l(e.ProductProperty,(function(t,a){return r("Form-item",{key:t.PropertyName,staticClass:"P-MB-10",attrs:{label:t.PropertyName+"："}},[e._l(t.PropertyValue,(function(t,o){return r("Tag",{key:t.PropertValue,staticClass:"P-MB-5",attrs:{type:"dot",closable:e.ModifyStatus,color:"primary"},on:{"on-close":function(t){return e.ClosePropertyTag("PropertyValue",a,o)}}},[e._v(e._s(t.PropertValue))])})),e.ModifyStatus?r("Input",{attrs:{placeholder:"新品属性值"},on:{"on-enter":function(t){return e.AddPropertyTag("PropertyValue",a)}},model:{value:e.AddPropertyValue[a],callback:function(t){e.$set(e.AddPropertyValue,a,t)},expression:"AddPropertyValue[Index]"}},[r("Button",{attrs:{slot:"append"},on:{click:function(t){return e.AddPropertyTag("PropertyValue",a)}},slot:"append"},[e._v("添加")])],1):e._e()],2)})),1)],1)])])]),e.ModifyStatus?e._e():r("TabPane",{attrs:{label:"审核信息",name:"Review"}},[r("Table",{attrs:{columns:e.ReviewCol,data:e.ReviewList,size:"small",stripe:"",height:400}})],1)],1)],1),r("ShowBigPic",{ref:"ShowBigPic"}),r("EnableSupplier",{ref:"EnableSupplier",attrs:{AddCityList:e.CityTrees},on:{"emit-eable-supplier":e.CloseEnableSupplier}}),r("ModifySupplier",{attrs:{TriggerModifySupplier:e.TriggerModifySupplier,IsEdit:[],AreaTree:e.CityTrees},on:{"emit-supplier":e.HandleResSupplier}}),e.ModifyStatus?r("footer",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{on:{click:function(t){return e.ArrangeProductData(!0)}}},[e._v("提交审核")]),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ArrangeProductData(!1)}}},[e._v(e._s(0===e.SelecData.length?"添加":"修改"))]),r("Button",{on:{click:function(t){return e.ClearModal(0)}}},[e._v("取消")])],1):e._e(),e.IsReview||!e.ModifyStatus?r("footer",{attrs:{slot:"footer"},slot:"footer"},[e.IsReview?r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ReviewProductDev(1)}}},[e._v("通过")]):e._e(),e.IsReview?r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ReviewProductDev(2)}}},[e._v("不通过")]):e._e(),e.IsReview?r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.ReviewProductDev(3)}}},[e._v("退回修改")]):e._e(),r("Button",{on:{click:function(t){return e.ClearModal(0)}}},[e._v(e._s(e.IsReview?"取消":"返回"))])],1):e._e()],1)],1)],1)},o=[],i=(r("d9b9"),r("9660"),r("0a9c"),r("76bb"),r("cee1"),r("1ff3"),r("e8f2"),r("ef8f"),r("6bf8"),r("b916"),r("eb83"),r("d088"),r("b74e"),r("0b78"),r("5c62")),s=(r("b449"),r("5d83")),n=r("3231"),u=r("064d"),l=r("46d7"),c=r("631e"),d=r("4a81"),p=r("d11d"),P=r("eb49"),h=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(n["a"])(this,r),e=t.apply(this,arguments),e.ActivedQuality=!1,e.ShowModal=!1,e.ModifyStatus=!1,e.ModifyStatusObj={Boolean:!1},e.IsReview=!1,e.IsLoadingEnableTab=!0,e.ShowSupplierModal=!1,e.ChooseSupplyIndex=0,e.TriggerModifySupplier=!1,e.SelecData=[],e.Tree=[],e.CityTrees=[],e.UploadImgServer=e.$Server.Settings+e.$Api.UploadImage,e.ProductDevDetails=new P["a"].ProductDevDetails,e.ProductAttribute=new P["a"].ProductAttribute,e.ProductSupplyInfo=[],e.ProductMatch=[],e.ProductProperty=[],e.ProfitData=new P["a"].ProfitData,e.ProductDevRules={Id:[{required:!1}],ImageUrl:[{required:!0,message:"请上传图片",trigger:"change"}],ProductName:[{required:!0,message:"请输入产品名"}],Platfrom:[{required:!0,message:"请选择平台",trigger:"change",type:"number"}],SaleKeyWord:[{required:!1}],Weight:[{required:!0,message:"请输入重量",trigger:"change",type:"number",min:2e-10}],CategoryId:[{required:!0,message:"请选择品类",trigger:"change",type:"array"}],CategoryName:[{required:!1}],CategoryNum:[{required:!0,message:"请输入SKU序号"},{pattern:/^[0-9]{1,3}$/,message:"请输入正确的SKU序号"}],SalePrice:[{required:!1}],SPCurrencyCode:[{required:!1}],GrossProfit:[{required:!1}],DevManager:[{required:!0,message:"请选择产品经理",trigger:"change",type:"number"}],DevMangerName:[{required:!1}],SaleManager:[{required:!0,message:"请选择销售主管",trigger:"change",type:"number"}],SaleManagerName:[{required:!1}],Creator:[{required:!0,message:"请选择开发员",trigger:"change",type:"number"}],CreatorName:[{required:!1}],CreateTime:[{required:!1}],CompleteTime:[{required:!1}],Remark:[{required:!1}],Status:[{required:!1}],Attribute:[{required:!0,message:"请选择特性标签",trigger:"change",type:"array"}]},e.AddPropertyName="",e.AddPropertyValue=[],e.ProfitExchange=1,e.SaleExchange=2,e.DropAttribute=[],e.DropDevUser=[],e.DropDevManager=[],e.DropSaleManager=[],e.DropPlatform=e.$Utils.GetEnumArr(e.$Enums.Sales.Platform),e.DropER=[],e.ReviewRemark="",e.ActiveTab="Base",e.ReviewCol=[{title:"编号",width:100,key:"Id"},{title:"审核人",key:"Operator"},{title:"审核结果",key:"OperateType",render:function(e,t){return e("span",["","通过","不通过","退回修改"][t.row.OperateType])}},{title:"审核时间",key:"OperateTime",width:160,render:function(t,r){return t("span",e.$UI.Render.Date(r.row.OperateTime,!0))}},{title:"备注",key:"Remark"}],e.ReviewList=[],e.SupplyDataCol=[{title:"默认",key:"IsDefault",width:90,render:function(t,r){return t("span",{class:"P-Pointer P-Text-Info",on:{click:function(){e.ChangeDefault("ProductSupplyInfo",r.row._index)}}},r.row.IsDefault?"已默认":"默认")}},{title:"供应商",key:"SupplyName"},{title:"采购价",key:"IsDefault",width:220,render:function(t,r){return e.ModifyStatusObj.Boolean?t("div",[t("InputNumber",{props:{value:r.row.PurchasePrice},on:{"on-change":function(t){e.SupplyDataList[r.row._index].PurchasePrice=t,e.ChangeSalePrice(r.row._index)}}}),t("Select",{props:{value:r.row.CurrencyCode,clearable:!0,filterable:!0,options:e.DropER,onChange:function(t){r.row.CurrencyCode=t,e.ChangeCurrency("ProductSupplyInfo",r.row._index)}},style:{width:"100px"}})]):t("span","".concat(r.row.PurchasePrice).concat(r.row.CurrencyCode))}},{title:"采购链接",key:"PurchaseUrl",render:function(t,r){return e.ModifyStatusObj.Boolean?t("Input",{props:{placeholder:"采购链接",value:r.row.PurchaseUrl},on:{"on-change":function(t){e.SupplyDataList[r.row._index].PurchaseUrl=t.target.value}}}):t("a",{on:{"click.prevent":function(){e.JumpPage(r.row.PurchaseUrl)}}},r.row.PurchaseUrl||"-")}},{title:"操作",width:180,render:function(t,r){return t("div",[t("Button",{props:{type:"error",size:"small"},class:"P-MR-5",on:{click:function(){e.DeleteLine("ProductSupplyInfo",r.row._index)}}},"删除"),t("Button",{props:{type:"primary",size:"small"},on:{click:function(){e.ChooseEnableSupply(r.row._index)}}},"选择供应商")])}}],e.ProfitDataCols=[{title:"利润率",render:function(t,r){return e.ModifyStatusObj.Boolean?t("div",[t("InputNumber",{props:{min:0,placeholder:"利润率",value:r.row.GrossProfit},on:{"on-change":function(t){e.ProfitData.GrossProfit=t,e.ChangeGrossProfit()}}}),t("span","%")]):t("span","".concat(e.ProfitData.GrossProfit,"%"))}},{title:"利润",render:function(t,r){return t("span","".concat((e.ProfitData.SalePrice*e.ProfitExchange*(.01*e.ProfitData.GrossProfit)).toFixed(2),"CNY"))}},{title:"预售价",render:function(t,r){return e.ModifyStatusObj.Boolean?t("div",[t("InputNumber",{props:{min:0,placeholder:"预售价",value:r.row.SalePrice},on:{"on-change":function(t){e.ProfitData.SalePrice=t}}}),t("Select",{props:{value:r.row.SPCurrencyCode,clearable:!0,filterable:!0,options:e.DropER,onChange:function(t){r.row.SPCurrencyCode=t,e.ChangeCurrency("Sale")}},style:{width:"100px"}})]):t("span","".concat(e.ProfitData.SalePrice).concat(e.ProfitData.SPCurrencyCode))}}],e.MatchCols=[{title:"默认",key:"IsDefault",width:90,render:function(t,r){return t("span",{class:"P-Pointer P-Text-Info",on:{click:function(){e.ChangeDefault("ProductMatch",r.row._index)}}},r.row.IsDefault?"已默认":"默认")}},{title:"竞品售价",key:"SalePrice",width:220,render:function(t,r){return e.ModifyStatusObj.Boolean?t("div",[t("InputNumber",{props:{value:r.row.SalePrice},on:{"on-change":function(t){e.ProductMatch[r.row._index].SalePrice=t}}}),t("Select",{props:{value:r.row.CurrencyCode,clearable:!0,filterable:!0,options:e.DropER,onChange:function(t){r.row.CurrencyCode=t,e.ChangeCurrency("ProductSupplyInfo",r.row._index)}},style:{width:"100px"}})]):t("span","".concat(r.row.SalePrice).concat(r.row.CurrencyCode))}},{title:"竞品链接",key:"SaleUrl",render:function(t,r){return e.ModifyStatusObj.Boolean?t("Input",{props:{placeholder:"采购链接",value:r.row.SaleUrl},on:{"on-change":function(t){e.ProductMatch[r.row._index].SaleUrl=t}}}):t("a",{on:{"click.prevent":function(){e.JumpPage(r.row.SaleUrl)}}},r.row.SaleUrl||"-")}},{title:"操作",width:80,render:function(t,r){return t("Button",{props:{type:"error",size:"small"},class:"P-MR-5",on:{click:function(){e.DeleteLine("ProductMatch",r.row._index)}}},"删除")}}],e}return Object(u["a"])(r,[{key:"HandleResMsg",value:function(e){}},{key:"Trigger",value:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var r,a,o,s,n,u,l,c,d,p,h,f,y,v,D=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(u=t.SelectedData,l=t.DropAttribute,c=t.DropDevUser,d=t.DropDevManager,p=t.DropSaleManager,h=t.ModifyStatus,f=t.Tree,y=t.IsReview,(r=this.DropAttribute).splice.apply(r,[0,this.DropAttribute.length].concat(Object(i["a"])(l))),(a=this.DropDevUser).splice.apply(a,[0,this.DropDevUser.length].concat(Object(i["a"])(c))),(o=this.DropDevManager).splice.apply(o,[0,this.DropDevManager.length].concat(Object(i["a"])(d))),(s=this.DropSaleManager).splice.apply(s,[0,this.DropSaleManager.length].concat(Object(i["a"])(p))),(n=this.Tree).splice.apply(n,[0,this.Tree.length].concat(Object(i["a"])(f))),this.ActiveTab="Base",this.ModifyStatus=h,this.$set(this.ModifyStatusObj,"Boolean",h),this.IsReview=y,this.ChangeTableCols(this.ModifyStatus),!(u.length>0)){e.next=27;break}return(v=this.SelecData).splice.apply(v,[0,this.SelecData.length].concat(Object(i["a"])(u))),e.next=15,this.GetProductDevInfo(this.SelecData[0].Id);case 15:return e.next=17,this.GetProductAttribute(this.SelecData[0].Id);case 17:return e.next=19,this.GetProperty(this.SelecData[0].Id);case 19:return e.next=21,this.GetSupplyInfo(this.SelecData[0].Id);case 21:return e.next=23,this.GetMatchIfo(this.SelecData[0].Id);case 23:return e.next=25,this.GetReviewHistory(this.SelecData[0].Id);case 25:e.next=35;break;case 27:this.$set(this,"ProductDevDetails",new P["a"].ProductDevDetails),this.$set(this,"ProductAttribute",new P["a"].ProductAttribute),this.$set(this,"ProfitData",new P["a"].ProfitData),this.ProductSupplyInfo.splice(0,this.ProductSupplyInfo.length),this.ProductMatch.splice(0,this.ProductMatch.length),this.ProductProperty.splice(0,this.ProductProperty.length),this.ProductSupplyInfo.push(new P["a"].ProductSupplyInfo),this.ProductMatch.push(new P["a"].ProductMatch);case 35:return e.next=37,this.GetERList();case 37:this.CityTrees.length<1&&this.GetAreaTree(),this.$nextTick((function(){D.ShowModal=!0}));case 39:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"ChangeTabs",value:function(e){this.ActiveTab=e}},{key:"ChangeTableCols",value:function(e){var t=this;e?("默认"!==this.SupplyDataCol[0].title&&this.SupplyDataCol.unshift({title:"默认",key:"IsDefault",width:90,render:function(e,r){return e("span",{class:"P-Pointer",on:{click:function(){t.ChangeDefault("ProductSupplyInfo",r.row._index)}}},r.row.IsDefault?"已默认":"默认")}}),"操作"!==this.SupplyDataCol[this.SupplyDataCol.length-1].title&&this.SupplyDataCol.push({title:"操作",width:180,render:function(e,r){return e("div",[e("Button",{props:{type:"error",size:"small"},class:"P-MR-5",on:{click:function(){t.DeleteLine("ProductSupplyInfo",r.row._index)}}},"删除"),e("Button",{props:{type:"primary",size:"small"},on:{click:function(){t.ChooseEnableSupply(r.row._index)}}},"选择供应商")])}}),"默认"!==this.MatchCols[0].title&&this.MatchCols.unshift({title:"默认",key:"IsDefault",width:90,render:function(e,r){return e("span",{class:"P-Pointer",on:{click:function(){t.ChangeDefault("ProductMatch",r.row._index)}}},r.row.IsDefault?"已默认":"默认")}}),"操作"!==this.MatchCols[this.MatchCols.length-1].title&&this.MatchCols.push({title:"操作",width:80,render:function(e,r){return e("Button",{props:{type:"error",size:"small"},class:"P-MR-5",on:{click:function(){t.DeleteLine("ProductMatch",r.row._index)}}},"删除")}})):("默认"===this.SupplyDataCol[0].title&&this.SupplyDataCol.shift(),"操作"===this.SupplyDataCol[this.SupplyDataCol.length-1].title&&this.SupplyDataCol.pop(),"默认"===this.MatchCols[0].title&&this.MatchCols.shift(),"操作"===this.MatchCols[this.MatchCols.length-1].title&&this.MatchCols.pop())}},{key:"GetProductDevInfo",value:function(e){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProductInfo,Login:!0},Data:e,Callback:function(e){if(e.IsSuccess){t.$set(t,"ProductDevDetails",e.Data.Data[0]),t.ProfitData.SPCurrencyCode=t.ProductDevDetails.SPCurrencyCode,t.ProfitData.GrossProfit=t.ProductDevDetails.GrossProfit;var r=JSON.parse(JSON.stringify(t.ProductDevDetails.CategoryId));t.ProductDevDetails.CategoryId=[],t.ProductDevDetails.CategoryId.unshift(r.toString()),t.FindParentIds(t.Tree,r)}else t.$Request.Error(e)}})}},{key:"GetProductAttribute",value:function(e){var t=this;this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProAttribute,Login:!0},Data:e,Callback:function(e){var r;e.IsSuccess?(t.ProductDevDetails.Attribute=[],t.ModifyStatus?(r=t.ProductDevDetails.Attribute).push.apply(r,Object(i["a"])(e.Data.Data.map((function(e){return e.AttributeId})))):t.ProductDevDetails.AttributeName=e.Data.Data.map((function(e){return e.AttributeName})).join(",")):t.$Request.Error(e)}})}},{key:"GetSupplyInfo",value:function(e){var t=this;this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProSupply,Login:!0},Data:e,Callback:function(e){var r;e.IsSuccess?((r=t.ProductSupplyInfo).splice.apply(r,[0,t.ProductSupplyInfo.length].concat(Object(i["a"])(e.Data.Data))),t.ProductSupplyInfo.forEach((function(e){e.IsDefault&&(t.GetExchange(e.CurrencyCode,t.ProfitData.SPCurrencyCode,"SaleExchange"),t.GetExchange(t.ProfitData.SPCurrencyCode,"CNY","ProfitExchange"))}))):t.$Request.Error(e)}})}},{key:"GetMatchIfo",value:function(e){var t=this;this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProMatch,Login:!0},Data:e,Callback:function(e){e.IsSuccess?t.$set(t,"ProductMatch",e.Data.Data):t.$Request.Error(e)}})}},{key:"GetProperty",value:function(e){var t=this;this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProperty,Login:!0},Data:e,Callback:function(e){e.IsSuccess?(t.$set(t,"ProductProperty",e.Data.Data),t.ProfitData.SalePrice=t.ProductDevDetails.SalePrice):t.$Request.Error(e)}})}},{key:"GetExchange",value:function(e,t,r){var a=this;this.$Request.Post({Server:this.$Server.Settings,Api:{Address:this.$Api.ERExchangeRate,Login:!0},Data:{SourceCode:e,TargetCode:t},Callback:function(e){e.IsSuccess?a.$set(a,r,e.Data.Rate):a.$Request.Error(e)}})}},{key:"GetReviewHistory",value:function(e){var t=this;this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductGetProReviewHistory,Login:!0},Data:e,Callback:function(e){var r;(t.$UI.Loading.Hide(),e.IsSuccess)?(r=t.ReviewList).splice.apply(r,[0,t.ReviewList.length].concat(Object(i["a"])(e.Data.Data))):t.$Request.Error(e)}})}},{key:"GetERList",value:function(){var e=this;this.$Request.Post({Server:this.$Server.Settings,Api:{Address:this.$Api.ERDropList,Login:!0},Data:"",Callback:function(t){var r;t.IsSuccess?(r=e.DropER).splice.apply(r,[0,e.DropER.length].concat(Object(i["a"])(t.Data.DropList))):e.$Request.Error(t)}})}},{key:"GetAreaTree",value:function(e){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Settings,Api:{Address:this.$Api.ProvincialAreasGetTree,Login:!1},Data:"",Callback:function(r){r.IsSuccess?(t.$set(t,"CityTrees",r.Data.Tree),t.SetTreeMenu(t.CityTrees),e&&e()):t.$Request.Error(r),t.$UI.Loading.Hide()}})}},{key:"SetTreeMenu",value:function(e){for(var t in e)this.$set(e[t],"label",e[t].Name),this.$set(e[t],"value",e[t].Id),0!=e[t].ChildNodes.length&&(e[t]["children"]=e[t].ChildNodes,this.SetTreeMenu(e[t].children))}},{key:"FindParentIds",value:function(e,t){for(var r in e)e[r].Id==t?(this.ProductDevDetails.CategoryId.unshift(e[r].ParentId.toString()),0!=e[r].ParentId&&this.FindParentIds(this.CagtegoryTree,Number(e[r].ParentId))):this.FindParentIds(e[r].ChildNodes,t)}},{key:"SetCategory",value:function(e){var t;(t=this.ProductDevDetails.CategoryId).splice.apply(t,[0,this.ProductDevDetails.CategoryId.length].concat(Object(i["a"])(e.map((function(e){return Number(e)})))))}},{key:"ClearModal",value:function(e){this.$set(this,"ShowModal",!1),this.HandleResMsg(0)}},{key:"HandleSuccess",value:function(e,t){1==e.IsSuccess?this.ProductDevDetails.ImageUrl=e.Data.Url:this.$Request.Error(e)}},{key:"HandleFormatError",value:function(e){this.$Notice.warning({title:"文件格式不正确",desc:"文件".concat(e.name,"格式不正确，请上传 jpg、 png 或 jpeg 格式的图片。")})}},{key:"HandleMaxSize",value:function(e){this.$Notice.warning({title:"超出文件大小限制",desc:"文件".concat(e.name,"太大，不能超过 2M。")})}},{key:"HandleRemove",value:function(){this.ProductDevDetails.ImageUrl=""}},{key:"JumpPage",value:function(e){if(""!==e){var t=e.startsWith("http://")||e.startsWith("https://")?e:"https://"+e;window.open(t)}}},{key:"ChangeDefault",value:function(e,t){for(var r in this[e])this[e][r].IsDefault=!1;this[e][t].IsDefault=!0,"ProductSupplyInfo"===e&&(this.ProfitData.SalePrice=this.ProductSupplyInfo[t].PurchasePrice/(1-.01*this.ProfitData.GrossProfit)*this.SaleExchange,this.GetExchange(this.ProductSupplyInfo[t].CurrencyCode,this.ProfitData.SPCurrencyCode,"SaleExchange"))}},{key:"ChangeSalePrice",value:function(e){1==this.ProductSupplyInfo[e].IsDefault&&(this.ProfitData.SalePrice=this.ProductSupplyInfo[e].PurchasePrice/(1-.01*this.ProfitData.GrossProfit)*this.SaleExchange)}},{key:"ChangeGrossProfit",value:function(){var e=0;for(var t in this.ProductSupplyInfo)this.ProductSupplyInfo[t].IsDefault&&(e=this.ProductSupplyInfo[t].PurchasePrice);this.ProfitData.SalePrice=e/(1-.01*this.ProfitData.GrossProfit)*this.SaleExchange}},{key:"ChangeCurrency",value:function(e,t){if("ProductSupplyInfo"===e&&void 0!==t)this.ProductSupplyInfo[t].IsDefault&&this.GetExchange(this.ProductSupplyInfo[t].CurrencyCode,this.ProfitData.SPCurrencyCode,"SaleExchange");else if("Sale"===e)for(var r in this.ProductSupplyInfo)this.ProductSupplyInfo[r].IsDefault&&(this.GetExchange(this.ProductSupplyInfo[r].CurrencyCode,this.ProfitData.SPCurrencyCode,"SaleExchange"),this.GetExchange(this.ProfitData.SPCurrencyCode,"CNY","ProfitExchange"))}},{key:"DeleteLine",value:function(e,t){var r=this[e][t].CurrencyCode;if(!(this[e].length<2)){this[e].splice(t,1);var a=!1;for(var o in this[e])this[e][o].IsDefault&&(a=!0);a||(this[e][0].IsDefault=!0,"Supply"==e&&(this.ProfitData.SalePrice=this.ProductSupplyInfo[0].PurchasePrice/(1-.01*this.ProfitData.GrossProfit)*this.SaleExchange,r!==this.ProductSupplyInfo[0].CurrencyCode&&this.GetExchange(this.ProductSupplyInfo[0].CurrencyCode,this.ProfitData.SPCurrencyCode,"SaleExchange")))}}},{key:"AddLine",value:function(e){"Supply"===e?(this.ProductSupplyInfo.push(new P["a"].ProductSupplyInfo),this.ProductSupplyInfo[this.ProductSupplyInfo.length-1].IsDefault=!1):"Match"===e&&(this.ProductMatch.push(new P["a"].ProductMatch),this.ProductMatch[this.ProductMatch.length-1].IsDefault=!1)}},{key:"AddSupplier",value:function(){var e=this;this.CityTrees.length<1?this.GetAreaTree((function(){e.TriggerModifySupplier=!0})):this.TriggerModifySupplier=!0}},{key:"HandleResSupplier",value:function(e){this.TriggerModifySupplier=!1}},{key:"ChooseEnableSupply",value:function(e){this.ChooseSupplyIndex=e,this.$refs["EnableSupplier"].TriggerModal(!1,this.IsLoadingEnableTab,!1)}},{key:"CloseEnableSupplier",value:function(e,t,r){this.IsLoadingEnableTab=t,e&&(this.ProductSupplyInfo[this.ChooseSupplyIndex].SupplyId=r[0].Id,this.ProductSupplyInfo[this.ChooseSupplyIndex].SupplyName=r[0].SupplyName)}},{key:"AddPropertyTag",value:function(e,t){var r=this;if("ProductProperty"===e){var a=!1;if(""===this.AddPropertyName)return;if(this.ProductProperty.forEach((function(e){e.PropertyName===r.AddPropertyName&&(a=!0,r.AddPropertyName="")})),a)return void this.$UI.Tips.Floating("warning","该属性已被添加");if(this.ProductProperty.length>=3)return this.$UI.Tips.Floating("warning","只能添加3个新品属性"),void(this.AddPropertyName="");this.ProductProperty.push({Id:0,ProductId:this.ProductDevDetails.Id,PropertyName:this.AddPropertyName,PropertyValue:[]}),this.AddPropertyName=""}else if("PropertyValue"===e&&void 0!==t){if(""==this.AddPropertyValue[t])return;for(var o in this.ProductProperty[t].PropertyValue)if(this.ProductProperty[t].PropertyValue[o].PropertValue==this.AddPropertyValue[t])return this.$UI.Tips.Floating("warning","该属性值已被添加"),void(this.AddPropertyValue[t]="");this.ProductProperty[t].PropertyValue.push({Id:0,PropertyId:this.ProductProperty[t].Id,PropertValue:this.AddPropertyValue[t]}),this.AddPropertyValue[t]=""}}},{key:"ClosePropertyTag",value:function(e,t,r){"ProductProperty"===e?this.ProductProperty.splice(t,1):"PropertyValue"===e&&void 0!==r&&this.ProductProperty[t].PropertyValue.splice(r,1)}},{key:"ArrangeProductData",value:function(e){var t=this;this.$refs["ProductDevDetails"].validate((function(r){if(r)if(""!=t.ProductDevDetails.ImageUrl){for(var a in t.ProductSupplyInfo){if(0==t.ProductSupplyInfo[Number(a)].SupplyId||""===t.ProductSupplyInfo[Number(a)].SupplyId.toString())return t.$UI.Tips.Floating("warning","请选择第【".concat(Number(a)+1,"】个供应商的供应商")),void t.showWarning("warning","");if(t.ProductSupplyInfo[Number(a)].PurchasePrice<=0)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(a)+1,"】个供应商的采购单价，采购单价必须大于0。"));if(""==t.ProductSupplyInfo[Number(a)].CurrencyCode)return void t.$UI.Tips.Floating("warning","请选择第【".concat(Number(a)+1,"】个供应商的采购币种"));if(""==t.ProductSupplyInfo[Number(a)].PurchaseUrl)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(a)+1,"】个供应商的采购链接"))}for(var o in t.ProductMatch){if(""===t.ProductMatch[Number(o)].SalePrice.toString()||t.ProductMatch[o].SalePrice<=0)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(o)+1,"】个竞品的竞品售价，竞品售价必须大于0。"));if(""==t.ProductMatch[Number(o)].CurrencyCode)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(o)+1,"】个竞品的竞品售价币种"));if(""==t.ProductMatch[Number(o)].SaleUrl)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(o)+1,"】个竞品的竞品链接"))}if(t.ProductProperty.length>0)for(var i in t.ProductProperty)if(t.ProductProperty[Number(i)].PropertyValue.length<1)return void t.$UI.Tips.Floating("warning","请填写第【".concat(Number(i)+1,"】个新品属性添加属性值"));var s={Product:JSON.parse(JSON.stringify(t.ProductDevDetails)),Supply:JSON.parse(JSON.stringify(t.ProductSupplyInfo)),Match:JSON.parse(JSON.stringify(t.ProductMatch)),Property:JSON.parse(JSON.stringify(t.ProductProperty)),Attribute:[],IsToReview:e};for(var n in t.ProductDevDetails.Attribute)s.Attribute.push({ProductId:t.ProductDevDetails.Id,AttributeId:t.ProductDevDetails.Attribute[Number(n)],AttributeName:""});s.Product.CategoryNum=t.AddZero(s.Product.CategoryNum),s.Product.GrossProfit=t.ProfitData.GrossProfit,s.Product.SPCurrencyCode=t.ProfitData.SPCurrencyCode,s.Product.SalePrice=t.ProfitData.SalePrice,s.Product.CategoryId=Number(s.Product.CategoryId[s.Product.CategoryId.length-1]),delete s.Product.Attribute,t.PostProductDev(s)}else t.$UI.Tips.Floating("warning","请上传图片")}))}},{key:"PostProductDev",value:function(e){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:0===this.SelecData.length?this.$Api.ProductCreate:this.$Api.ProductModify,Login:!0},Data:e,Callback:function(r){t.$UI.Loading.Hide(),r.IsSuccess?(t.$UI.Tips.Floating("success",e.IsToReview?"提审新品成功":"".concat(0===t.SelecData.length?"添加":"修改","新品申请成功")),t.ClearModal(1)):t.$Request.Error(r)}})}},{key:"ReviewProductDev",value:function(e){var t=this;this.$UI.Loading.Show();var r={Id:[this.SelecData[0].Id],ReviewType:e,Remark:this.ReviewRemark};this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.ProductProReview,Login:!0},Data:r,Callback:function(e){t.$UI.Loading.Hide(),e.IsSuccess?(t.$UI.Tips.Floating("success","审核新品申请成功"),t.ClearModal(1)):t.$Request.Error(e)}})}},{key:"AddZero",value:function(e){var t=e.split("");return t.length>=3?t.join(""):t.length>=2?"0"+t.join(""):t.length>=1?"00"+t.join(""):""}},{key:"ShowPic",value:function(e){this.$refs.ShowBigPic.Triger(e)}}]),r}(p["d"]);d["a"]([Object(p["b"])()],h.prototype,"HandleResMsg",null),h=d["a"]([Object(p["a"])({name:"ModifyProductDev",components:{ShowBigPic:function(){return r.e("chunk-c0a1d894").then(r.bind(null,"6156"))},EnableSupplier:function(){return r.e("chunk-2d224590").then(r.bind(null,"e06e"))},ModifySupplier:function(){return r.e("chunk-2d0aa957").then(r.bind(null,"1244"))}}})],h);var f=h,y=f,v=(r("b33f"),r("4023")),D=Object(v["a"])(y,a,o,!1,null,null,null);t["default"]=D.exports},"9c616":function(e,t,r){},b33f:function(e,t,r){"use strict";var a=r("9c616"),o=r.n(a);o.a}}]);