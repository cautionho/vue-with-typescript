(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b1a12"],{2152:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Row",[s("Col",{attrs:{span:"24"}},[s("Form",{ref:"SearchForm",attrs:{inline:"",onsubmit:"return false"},model:{value:e.SearchForm,callback:function(t){e.SearchForm=t},expression:"SearchForm"}},[s("FormItem",{staticClass:"P-MB-10"},[s("Input",{staticClass:"P-W-400",attrs:{placeholder:"搜索关键字"},model:{value:e.SearchForm.SearchKey,callback:function(t){e.$set(e.SearchForm,"SearchKey",t)},expression:"SearchForm.SearchKey"}},[s("Select",{staticClass:"P-W-100 P-TA-L",attrs:{slot:"prepend",placeholder:"搜索关键词",options:e.SearchKeyTypeDrop},slot:"prepend",model:{value:e.SearchForm.SearchKeyType,callback:function(t){e.$set(e.SearchForm,"SearchKeyType",t)},expression:"SearchForm.SearchKeyType"}}),s("Button",{attrs:{slot:"append",type:"primary"},on:{click:e.SearchList},slot:"append"},[e._v("搜索")])],1)],1),s("FormItem",{staticClass:"P-MB-10"},[s("Button",{attrs:{type:"warning"}},[e._v("重置")])],1)],1)],1),s("Col",{attrs:{span:"24"}},["Product"===e.Type&&e.Powers.AddProductRule||"StockUp"===e.Type&&e.Powers.AddStockUpRule?s("ModifyAbroadWarehouseRules",{ref:"ModifyAbroadWarehouseRules",attrs:{Type:e.Type,DropAbroadWarehouse:e.DropAbroadWarehouse},on:{"handle-res-msg":e.HandleResMsg}}):e._e(),"Product"===e.Type&&e.Powers.SetProductRuleIsEnable||"StockUp"===e.Type&&e.Powers.SetStockUpRuleIsEnable?s("ChangeStatus",{ref:"ChangeStatus",staticClass:"P-MB-10",on:{"emit-change":e.EmitChange}}):e._e()],1),s("Col",{staticClass:"P-MB-10",attrs:{span:"24"}},[s("Table",{ref:"Table",attrs:{columns:"Product"===e.Type?e.ProductCols:e.StockUpCols,data:e.List,size:"small",stripe:"",height:e.CalculateTbHeight()},on:{"on-selection-change":e.GetSelected}})],1),s("Col",{attrs:{span:"24"}},[s("Page",{attrs:{current:e.Pager.PageIndex,total:e.Pager.TotalItems,"page-size":e.Pager.PageSize,"page-size-opts":e.Pager.PageOpt,"show-total":"","show-sizer":"","show-elevator":""},on:{"on-change":e.ChangePage,"on-page-size-change":e.ChangePageSize}})],1)],1)},r=[],i=(s("d9b9"),s("76bb"),s("e8f2"),s("6bf8"),s("3231")),o=s("064d"),n=s("46d7"),l=s("631e"),c=s("4a81"),h=s("d11d"),u=s("db83"),d=s("1f41"),p=function(e){Object(n["a"])(s,e);var t=Object(l["a"])(s);function s(){var e;return Object(i["a"])(this,s),e=t.apply(this,arguments),e.Powers={},e.OperateDrop=[],e.Pager=new u["a"].Pager,e.SearchForm=new d["a"].AboadWareSearch,e.SearchKeyTypeDrop=e.$Utils.GetEnumArr(e.$Enums.Public.Enable),e.ChangeStatusObj={Server:e.$Server.Settings,Api:"Product"===e.Type?e.$Api.SetProductRuleIsEnable:e.$Api.SetStockUpRuleIsEnable,IdKey:"Id",StatusKey:"IsEnable",ToTarget:!1,TipsKey:"规则"},e.Selected=[],e.List=[],e.ProductCols=[{type:"selection",width:60,align:"center"},{title:"编号",key:"Sequence",width:60},{title:"海外仓库",key:"WarehouseName"},{title:"日均销量阈值",key:"ThresholdValue"},{title:"状态",key:"IsEnable",width:80,render:function(e,t){return e("div",{class:t.row.IsEnable?"P-Text-Success":"P-Text-Error"},t.row.IsEnable?"已启用":"已禁用")}},{title:"操作",width:140,render:function(t,s){return t("div",e.OperateDrop.map((function(a,r){return t("Button",{props:{type:2===a.Value&&s.row.IsEnable?"error":"primary",size:"small"},class:0==r?"P-MR-5":"",on:{click:function(){e.OperateGroup(Number(a.Value),s.row._index)}}},2==a.Value?s.row.IsEnable?"禁用":"启用":a.Key)})))}}],e.StockUpCols=[{type:"selection",width:60,align:"center"},{title:"编号",key:"Sequence",width:60},{title:"海外仓库",key:"WarehouseName"},{title:"日均销量阈值",key:"ThresholdValue",render:function(e,t){return e("span","".concat(t.row.SaleSlowQty," ~ ").concat(t.row.SaleHighQty))}},{title:"备货天数",key:"StockupDays"},{title:"状态",key:"IsEnable",width:80,render:function(e,t){return e("div",{class:t.row.IsEnable?"P-Text-Success":"P-Text-Error"},t.row.IsEnable?"已启用":"已禁用")}},{title:"操作",width:140,render:function(t,s){return t("div",e.OperateDrop.map((function(a,r){return t("Button",{props:{type:2===a.Value&&s.row.IsEnable?"error":"primary",size:"small"},class:0==r?"P-MR-5":"",on:{click:function(){e.OperateGroup(Number(a.Value),s.row._index)}}},2==a.Value?s.row.IsEnable?"禁用":"启用":a.Key)})))}}],e}return Object(o["a"])(s,[{key:"mounted",value:function(){this.GetPoints()}},{key:"GetPoints",value:function(){this.$UI.Loading.Show();var e="Product"===this.Type?["AddProductRule","ModifyProductRule","SetProductRuleIsEnable"]:["AddStockUpRule","ModifyStockUpRule","SetStockUpRuleIsEnable"];this.$set(this,"Powers",this.$Utils.GetUserResource.call(this,e)),this.SetOperateDrop()}},{key:"SetOperateDrop",value:function(){var e,t=[];("Product"===this.Type&&this.Powers.ModifyProductRule||"StockUp"===this.Type&&this.Powers.ModifyStockUpRule)&&t.push({Key:"编辑",Value:1}),("Product"===this.Type&&this.Powers.SetProductRuleIsEnable||"StockUp"===this.Type&&this.Powers.SetStockUpRuleIsEnable)&&t.push({Key:"启禁用",Value:2}),(e=this.OperateDrop).push.apply(e,t),this.GetList()}},{key:"GetList",value:function(){var e=this;this.$set(this,"AccurateSearch",!1),this.$UI.Loading.Show(),this.$set(this,"List",[]),this.$set(this.SearchForm,"IsEnable",""===this.SearchForm.SearchKeyType?"":[!1,!0][this.SearchForm.SearchKeyType]);var t=JSON.parse(JSON.stringify(this.SearchForm));delete t.SearchKeyType,this.$Request.Post({Server:this.$Server.Settings,Api:{Address:"Product"===this.Type?this.$Api.GetProductRuleList:this.$Api.GetStockUpRuleList,Login:!0},Data:{PageIndex:this.Pager.PageIndex,PageSize:this.Pager.PageSize,Conditions:t},Callback:function(t){t.IsSuccess?(e.Pager.TotalItems=t.Data.PageModel.TotalItems,e.$set(e,"List",t.Data.PageModel.Items)):e.$Request.Error(t),e.$UI.Loading.Hide()}})}},{key:"GetSelected",value:function(e){this.$set(this,"Selected",e)}},{key:"CancelSelect",value:function(){this.$set(this,"Selected",[])}},{key:"SearchList",value:function(){this.$set(this.Pager,"PageIndex",1),this.GetList()}},{key:"ResetList",value:function(){this.$set(this,"Pager",new u["a"].Pager),this.$set(this,"SearchForm",new d["a"].AboadWareSearch),this.GetList()}},{key:"ChangePageSize",value:function(e){this.$set(this.Pager,"PageSize",e),this.GetList()}},{key:"ChangePage",value:function(e){this.$set(this.Pager,"PageIndex",e),this.GetList()}},{key:"CalculateTbHeight",value:function(){var e=250;for(var t in this.Powers)this.Powers[t]&&(e=305);return window.innerHeight-e}},{key:"OperateGroup",value:function(e,t){switch(t&&(this.CancelSelect(),this.$set(this,"Selected",[JSON.parse(JSON.stringify(this.List[t]))])),this.$set(this,"Selected","number"===typeof t?[JSON.parse(JSON.stringify(this.List[t]))]:[]),e){case 1:this.$refs["ModifyAbroadWarehouseRules"].Trigger(this.Selected);break;case 2:this.ChangeStatusObj.ToTarget=!this.Selected[0].IsEnable,this.ChangeStatusObj.IdKey="Product"===this.Type?"WarehouseIds":"Ids",this.$refs["ChangeStatus"].TriggerModal(this.Selected,this.ChangeStatusObj);break}}},{key:"HandleResMsg",value:function(e){this.CancelSelect(),1==e?this.GetList():2==e?this.OperateGroup(1):3==e&&this.GetList()}},{key:"EmitChange",value:function(e,t){void 0!==t?(this.ChangeStatusObj.ToTarget=1===t,this.ChangeStatusObj.IdKey="Product"===this.Type?"WarehouseIds":"Ids",this.$refs["ChangeStatus"].TriggerModal(this.Selected,this.ChangeStatusObj)):this.CancelSelect(),e&&this.GetList()}}]),s}(h["d"]);c["a"]([Object(h["c"])()],p.prototype,"Type",void 0),c["a"]([Object(h["c"])()],p.prototype,"DropAbroadWarehouse",void 0),p=c["a"]([Object(h["a"])({name:"AbroadWarehouseRulesSettings",components:{ModifyAbroadWarehouseRules:function(){return s.e("chunk-2d0e217f").then(s.bind(null,"7cda"))},ChangeStatus:function(){return s.e("chunk-2d208ad9").then(s.bind(null,"a68f"))}}})],p);var S=p,y=S,g=s("4023"),P=Object(g["a"])(y,a,r,!1,null,null,null);t["default"]=P.exports}}]);