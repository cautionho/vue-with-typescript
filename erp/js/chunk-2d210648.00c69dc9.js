(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d210648"],{b862:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Col",[r("Button",{attrs:{type:"primary"},on:{click:e.Trigger}},[e._v("更新发货仓")]),r("Modal",{attrs:{title:"更新发货仓",width:600},on:{"on-cancel":e.CancelModal},model:{value:e.WarehouseModal,callback:function(t){e.WarehouseModal=t},expression:"WarehouseModal"}},[r("Form",{ref:"WarehouseInfo",attrs:{model:e.WarehouseInfo,rules:e.WarehouseRules,"label-width":90,onsubmit:"return false;"}},[r("FormItem",{attrs:{label:"发货仓：",prop:"WarehouseId"}},[r("Select",{attrs:{placeholder:"发货仓",options:e.WarehouseDrop,onChange:e.ChangeWarehouse},model:{value:e.WarehouseInfo.WarehouseId,callback:function(t){e.$set(e.WarehouseInfo,"WarehouseId",t)},expression:"WarehouseInfo.WarehouseId"}})],1)],1),r("Form",{ref:"MethodInfo",attrs:{model:e.MethodInfo,rules:e.MethodRules,"label-width":90,onsubmit:"return false;"}},[r("FormItem",{attrs:{label:"物流渠道：",prop:"MethodId"}},[r("Select",{ref:"MethodDrop",attrs:{placeholder:"物流渠道",options:e.ShipMethodDrop,optionValKey:"Id",optionKey:"Name"},model:{value:e.MethodInfo.MethodId,callback:function(t){e.$set(e.MethodInfo,"MethodId",t)},expression:"MethodInfo.MethodId"}})],1)],1),r("footer",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.Post}},[e._v("提交")]),r("Button",{on:{click:e.CancelModal}},[e._v("取消")])],1)],1)],1)},a=[],s=(r("76bb"),r("6ed5"),r("6bf8"),r("b449"),r("5d83")),n=r("5c62"),i=r("430a"),h=r("e24e"),u=r("3231"),d=r("064d"),l=r("46d7"),c=r("631e"),p=r("4a81"),f=r("d11d"),I=r("1459"),v=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(u["a"])(this,r),e=t.apply(this,arguments),e.WarehouseModal=!1,e.WarehouseDrop=[],e.WarehouseInfo=new I["a"].SetWarehouse,e.WarehouseRules={WarehouseId:[{required:!0,message:"请选择发货仓",trigger:"change",type:"number"},{pattern:e.$Pattern.PositiveNotZeroInt,message:"请选择发货仓",trigger:"change"}]},e.ShipMethodDrop=[],e.MethodInfo=new I["a"].SetShippintMethod,e.MethodRules={MethodId:[{required:!0,message:"请选择物流渠道",trigger:"change",type:"number"},{pattern:e.$Pattern.PositiveNotZeroInt,message:"请选择物流渠道",trigger:"change"}]},e}return Object(d["a"])(r,[{key:"TriggerOperations",value:function(e){}},{key:"EmitOperateSuccess",value:function(){}},{key:"Trigger",value:function(){this.TriggerOperations("ChangeShipWarehouse")}},{key:"Validate",value:function(e){var t,r=this,o=Object(h["a"])(e);try{var a=function(){var e=t.value;if(![7,9].some((function(t){return t===e.ShipOrder.Status})))return r.$UI.Tips.Floating("warning","请选择状态为缺货、联系客户的发货订单进行操作"),{v:void 0}};for(o.s();!(t=o.n()).done;){var s=a();if("object"===Object(i["a"])(s))return s.v}}catch(n){o.e(n)}finally{o.f()}this.WarehouseInfo.OrderId=this.MethodInfo.OrderId=e.map((function(e){return e.ShipOrder.Id})),this.WarehouseInfo.WarehouseId=e[0].ShipOrder.ShipWarehouseId,this.WarehouseDrop.length||this.GetWarehouseDrop(),this.ShipMethodDrop.length||this.ChangeWarehouse(this.WarehouseInfo.WarehouseId),this.MethodInfo.MethodId=e[0].ShipOrder.ShippingMethodId,this.$set(this,"WarehouseModal",!0)}},{key:"GetWarehouseDrop",value:function(){var e=this;this.$Request.Post({Server:this.$Server.Settings,Api:{Address:this.$Api.GetWarehouseDropList},Data:!0,Callback:function(t){var r;t.IsSuccess?(r=e.WarehouseDrop).push.apply(r,Object(n["a"])(t.Data.DropList)):e.$Request.Error(t)}})}},{key:"ChangeWarehouse",value:function(e){var t=this;this.MethodInfo.MethodId=0,e?(this.$set(this,"ShipMethodDrop",[]),this.$Request.Post({Server:this.$Server.Logistics,Api:{Address:this.$Api.ChannelDropList},Data:e,Callback:function(e){var r;e.IsSuccess?(r=t.ShipMethodDrop).push.apply(r,Object(n["a"])(e.Data.DropList)):t.$Request.Error(e)}})):(this.$set(this,"ShipMethodDrop",[]),this.$refs.MethodDrop.clearSingleSelect())}},{key:"Post",value:function(){var e=this;this.$refs.WarehouseInfo.validate((function(t){t&&e.$refs.MethodInfo.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(r){var o,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=13;break}return t.next=3,e.PostInfo(e.$Server.Warehouse,e.$Api.ShipOrderSetWarehouse,e.WarehouseInfo);case 3:if(o=t.sent,!o.IsSuccess){t.next=11;break}return t.next=7,e.PostInfo(e.$Server.Warehouse,e.$Api.ShipOrderSetShippingMethod,e.MethodInfo);case 7:a=t.sent,a.IsSuccess?(e.$UI.Tips.Floating("success","更换发货仓成功"),e.EmitOperateSuccess(),e.CancelModal()):(e.$UI.Loading.Hide(),e.$Request.Error(a)),t.next=13;break;case 11:e.$UI.Loading.Hide(),e.$Request.Error(o);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))}},{key:"PostInfo",value:function(e,t,r){var o=this;return new Promise((function(a){o.$Request.Post({Server:e,Api:{Address:t,Login:!0},Data:r,Callback:function(e){a(e)}})}))}},{key:"CancelModal",value:function(){this.$set(this,"WarehouseModal",!1),this.$set(this,"WarehouseInfo",new I["a"].SetWarehouse),this.$refs.WarehouseInfo.resetFields()}}]),r}(f["d"]);p["a"]([Object(f["b"])()],v.prototype,"TriggerOperations",null),p["a"]([Object(f["b"])()],v.prototype,"EmitOperateSuccess",null),v=p["a"]([Object(f["a"])({name:"SetShipWarehouse"})],v);var g=v,W=g,S=r("4023"),M=Object(S["a"])(W,o,a,!1,null,null,null);t["default"]=M.exports}}]);