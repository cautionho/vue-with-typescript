(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d217305"],{c651:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Row",{staticClass:"P-Inline-Block"},[a("Button",{staticClass:"P-Inline-Block P-MR-10",attrs:{type:"primary"},on:{click:function(e){return t.ChangeModal(!0)}}},[t._v("批量打印SKU标签")]),a("Modal",{attrs:{title:"打印货架条码","mask-closable":!1,width:"950"},on:{"on-cancel":t.CancelModal},model:{value:t.BatchPrintSkuModal,callback:function(e){t.BatchPrintSkuModal=e},expression:"BatchPrintSkuModal"}},[a("Row",[a("Col",{attrs:{span:"4"}},[a("Button",{attrs:{type:"primary"},on:{click:t.OpenEnableSkuModal}},[t._v("添加SKU")])],1),a("Col",{attrs:{span:"20"}},[a("span",[t._v("修改打印数量为：")]),a("Input-number",{staticClass:"P-MR-5",attrs:{min:1},nativeOn:{keypress:function(e){return t.QtyyKeyPress(e)}},model:{value:t.PrintQuantity,callback:function(e){t.PrintQuantity=e},expression:"PrintQuantity"}}),a("Button",{on:{click:t.ChangeQty}},[t._v("修改")])],1)],1),a("Table",{ref:"SkuLabelTable",staticClass:"P-MT-10",attrs:{border:"",columns:t.SkuLabelCol,data:t.SelectData,height:"450",size:"small",stripe:""}}),a("footer",{staticClass:"P-TA-R",attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.ValidatePrint}},[t._v("打印")]),a("Button",{on:{click:t.CancelModal}},[t._v("取消")])],1)],1),a("EnableSku",{ref:"EnableSku",on:{"handle-res-msg":t.HandleSkuRes}})],1)},i=[],o=(a("9660"),a("cee1"),a("6bf8"),a("0b78"),a("3231")),l=a("064d"),u=a("46d7"),r=a("631e"),s=a("4a81"),c=a("d11d"),h=a("1f41"),d=a("2437"),k=function(t){Object(u["a"])(a,t);var e=Object(r["a"])(a);function a(){var t;return Object(o["a"])(this,a),t=e.apply(this,arguments),t.PrintQuantity=1,t.BatchPrintSkuModal=!1,t.SelectData=[],t.SkuLabelCol=[{title:"图片",width:80,render:function(e,a){return e("div",{style:{width:"30px",height:"30px",background:"url("+t.$Server.File+"/"+a.row.DefaultImage+") no-repeat",backgroundSize:"cover",margin:"0 auto"}})}},{title:"SKU编号",key:"SkuCode"},{title:"产品名",key:"SkuName"},{title:"产品名",key:"SkuName"},{title:"打印数量",render:function(e,a){return e("InputNumber",{style:{width:"80%"},props:{min:1,value:a.row.Quantity},on:{"on-change":function(e){t.SetTabInput(e,a.index,"Quantity")}}})}},{title:"操作",width:80,render:function(e,a){return e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.DeleteCols(a.index)}}},"删除")}}],t}return Object(l["a"])(a,[{key:"ChangeModal",value:function(t){}},{key:"CancelModal",value:function(){this.ResetList(),this.BatchPrintSkuModal=!1}},{key:"TriggerModal",value:function(t){this.SelectData=t,this.BatchPrintSkuModal=!0,this.SelectData.length>0&&this.ChangeQty()}},{key:"ResetList",value:function(){this.SelectData=[],this.PrintQuantity=1,this.ChangeModal(!1)}},{key:"OpenEnableSkuModal",value:function(){this.$refs["EnableSku"].Trigger(!1)}},{key:"HandleSkuRes",value:function(t){var e=this;t.forEach((function(t){var a=!0;if(e.SelectData.forEach((function(e){e.SkuCode.toLowerCase()===t.SkuCode.toLowerCase()&&(a=!1)})),a){var n=new h["a"].InventoryManageList;n["DefaultImage"]=t.DefaultImage,n["SkuCode"]=t.SkuCode,n["SkuName"]=t.SkuName,n["Quantity"]=1,e.GetLocationCode(n)}}))}},{key:"GetLocationCode",value:function(t){var e=this,a=new h["a"].SkuInventory;a["SkuId"]=0,a["WarehouseId"]=JSON.parse(this.$Cookie.Get("frler_user")).WarehouseId,a["SkuCode"]=t.SkuCode,this.$Request.Post({Server:this.$Server.Warehouse,Api:{Address:this.$Api.InventoryGetSkuInventory},Data:a,Callback:function(a){a.IsSuccess?(t.LocationCode=a.Data.Data.LocationCode,e.SelectData.push(t)):e.$Request.Error(a)}})}},{key:"ChangeQty",value:function(){var t=this;this.SelectData.forEach((function(e){e.Quantity=t.PrintQuantity}))}},{key:"QtyyKeyPress",value:function(t){13==t.keyCode&&this.ChangeQty()}},{key:"ValidatePrint",value:function(){if(this.SelectData.length<1)this.$UI.Tips.Floating("warning","请选择SKU进行打印操作");else{var t=!0;this.SelectData.forEach((function(e){0==e.Quantity&&(t=!1)})),t?this.PrintSkuLabel():this.$UI.Tips.Floating("warning","请输入SKU的打印数量")}}},{key:"PrintSkuLabel",value:function(){var t=this,e=null;e=Object(d["a"])(),this.$UI.Loading.Show(),this.SelectData.forEach((function(a,n){0!=n&&(e.PRINT_INITA("0mm","0mm","60mm","40mm",""),e.SET_PRINT_PAGESIZE(0,"60mm","40mm","SKU标签"),e.SET_PRINT_MODE("PRINT_NOCOLLATE",1),e.NewPage(),e.PRINT());for(var i=Math.ceil(a.Quantity/40),o=1;o<=i;o++){e.PRINT_INITA("0mm","0mm","60mm","40mm",""),e.SET_PRINT_PAGESIZE(0,"60mm","40mm","SKU标签"),e.SET_PRINT_MODE("PRINT_NOCOLLATE",1);for(var l=t.$Utils.ComputedSkuLabelAmount(o,a.Quantity,40),u=0;u<l;u++)t.$Utils.DesignSkuLabel(e,a.SkuCode,a.SkuCode,a.SkuName,a.LocationCode);e.PRINT()}})),this.$UI.Loading.Hide(),this.$UI.Tips.Floating("success","打印SKU标签成功"),this.ResetList()}},{key:"SetTabInput",value:function(t,e,a){this.SelectData[e][a]=t}},{key:"DeleteCols",value:function(t){this.SelectData.splice(t,1)}}]),a}(c["d"]);s["a"]([Object(c["b"])()],k.prototype,"ChangeModal",null),k=s["a"]([Object(c["a"])({name:"BatchPrintSkuLabel",components:{EnableSku:function(){return a.e("chunk-2d0dd9de").then(a.bind(null,"81c2"))}}})],k);var S=k,f=S,y=a("4023"),m=Object(y["a"])(f,n,i,!1,null,null,null);e["default"]=m.exports}}]);