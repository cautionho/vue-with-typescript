(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d699e"],{"72f3":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Row",{staticClass:"P-Inline-Block"},[r("Button",{attrs:{type:"primary"},on:{click:e.Trigger}},[e._v("取消后台单")]),r("Modal",{attrs:{title:"取消后台单",width:700},on:{"on-cancel":e.CancelModal},model:{value:e.BackOrderModal,callback:function(t){e.BackOrderModal=t},expression:"BackOrderModal"}},[r("Form",{ref:"BackOrderForm",attrs:{model:e.BackOrderForm,"label-width":90,onsubmit:"return false;"}},[r("FormItem",{attrs:{label:"取消原因",prop:"CancellingReason",rules:{required:!0,message:"请选择取消原因",trigger:"change",pattern:e.$Pattern.PositiveNotZero}}},[r("Select",{attrs:{placeholder:"取消原因",options:e.CancelReason},model:{value:e.BackOrderForm.CancellingReason,callback:function(t){e.$set(e.BackOrderForm,"CancellingReason",t)},expression:"BackOrderForm.CancellingReason"}})],1)],1),r("Table",{ref:"List",attrs:{columns:e.Cols,data:e.List,stripe:"",size:"small",height:300}}),r("footer",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.Validate}},[e._v("提交")]),r("Button",{on:{click:e.CancelModal}},[e._v("取消")])],1)],1)],1)},i=[],s=(r("76bb"),r("ef8f"),r("3231")),n=r("064d"),o=r("46d7"),c=r("631e"),l=r("4a81"),d=r("d11d"),u=r("a349"),h=r("4606"),k=function(e){Object(o["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(s["a"])(this,r),e=t.apply(this,arguments),e.BackOrderModal=!1,e.CancelReason=e.$Utils.GetEnumArr(e.$Enums.CustomerService.CancelBackReason),e.BackOrderForm=new h["a"].CancelBackOrder,e.List=[],e.Cols=[{type:"selection",width:60,align:"center"},{title:"LineNumber",key:"LineNumber",width:120},{title:"SKU编号",key:"SkuCode"},{title:"明细价格(单位：USD)",key:"ProductPrice",render:function(e,t){return e("span",t.row.ProductPrice.toFixed(3))}},{title:"数量",width:60,key:"Quantity"}],e}return Object(n["a"])(r,[{key:"Trigger",value:function(){this.GetCancelItems(),this.$set(this,"BackOrderModal",!0)}},{key:"GetCancelItems",value:function(){var e=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Sales,Api:{Address:this.$Api.AfterSaleGetListByShipOrderCode,Login:!0},Data:this["ShipOrder/SHIP_ORDER_INFO"].OrderCode,Callback:function(t){e.$UI.Loading.Hide(),t.IsSuccess?e.$set(e,"List",t.Data.Data):e.$Request.Error(t)}})}},{key:"Validate",value:function(){var e=this;this.$refs.BackOrderForm.validate((function(t){t&&(e.$refs.List.getSelection().length?e.PostCancelBackOrder():e.$UI.Tips.Floating("warning","请至少选择一条订单明细进行操作"))}))}},{key:"PostCancelBackOrder",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.BackOrderForm)),r=this.$refs.List.getSelection();t.Ids=r.map((function(e){return e.Id})),this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Sales,Api:{Address:this.$Api.AfterSaleCancellingOrderLines,Login:!0},Data:t,Callback:function(t){e.$UI.Loading.Hide(),t.IsSuccess?(e.$UI.Tips.Floating("success","取消成功"),e.CancelModal()):e.$Request.Error(t)}})}},{key:"CancelModal",value:function(){var e=this;this.$set(this,"BackOrderModal",!1),this.$set(this,"List",[]),this.$set(this,"BackOrderForm",new h["a"].CancelBackOrder),this.$nextTick((function(){e.$refs.BackOrderForm.resetFields()}))}}]),r}(d["d"]);l["a"]([u["b"]],k.prototype,"ShipOrder/SHIP_ORDER_INFO",void 0),k=l["a"]([Object(d["a"])({name:"CancelBackOrder"})],k);var O=k,f=O,p=r("4023"),m=Object(p["a"])(f,a,i,!1,null,"4fe030e0",null);t["default"]=m.exports}}]);