(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0dd9de"],{"81c2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{title:"选择SKU","mask-closable":!1,width:1400},on:{"on-cancel":function(t){e.EnableSkuModal=!1}},model:{value:e.EnableSkuModal,callback:function(t){e.EnableSkuModal=t},expression:"EnableSkuModal"}},[a("Row",[a("Col",{attrs:{span:"24"}},[a("Form",{ref:"SearchForm",attrs:{inline:"",onsubmit:"return false"},model:{value:e.SearchForm,callback:function(t){e.SearchForm=t},expression:"SearchForm"}},[a("FormItem",{staticClass:"P-MB-10"},[a("Dropdown",{attrs:{trigger:"custom",visible:e.AccurateSearch,placement:"bottom-start"}},[a("Button",{attrs:{type:"primary"},on:{click:e.TriggerSearch}},[e._v(" 精准搜索 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1),a("Col",{staticClass:"P-P-10",attrs:{slot:"list",span:"24"},slot:"list"},[a("Select",{staticClass:"P-W-200 P-ML-10",attrs:{placeholder:"平台",options:e.DropPlatformList},model:{value:e.SearchForm.WarehouseId,callback:function(t){e.$set(e.SearchForm,"WarehouseId",t)},expression:"SearchForm.WarehouseId"}}),a("Select",{staticClass:"P-W-200 P-ML-10",attrs:{placeholder:"状态",options:e.DropStatus},model:{value:e.SearchForm.Status,callback:function(t){e.$set(e.SearchForm,"Status",t)},expression:"SearchForm.Status"}}),a("Select",{staticClass:"P-W-200 P-ML-10",attrs:{placeholder:"品牌",options:e.DropBrandList},model:{value:e.SearchForm.Purchaser,callback:function(t){e.$set(e.SearchForm,"Purchaser",t)},expression:"SearchForm.Purchaser"}})],1)],1),a("FormItem",{staticClass:"P-ML-10"},[a("Input",{staticClass:"P-W-400",attrs:{placeholder:"搜索关键字"},model:{value:e.SearchForm.SearchKey,callback:function(t){e.$set(e.SearchForm,"SearchKey",t)},expression:"SearchForm.SearchKey"}},[a("Select",{staticClass:"P-W-100 P-TA-L",attrs:{slot:"prepend",placeholder:"搜索关键词",options:e.SearchKeyTypeDrop},slot:"prepend",model:{value:e.SearchForm.SearchKeyType,callback:function(t){e.$set(e.SearchForm,"SearchKeyType",t)},expression:"SearchForm.SearchKeyType"}}),a("Button",{attrs:{slot:"append",type:"primary"},on:{click:e.SearchList},slot:"append"},[e._v("搜索")])],1)],1),a("Button",{attrs:{type:"warning"},on:{click:e.ResetList}},[e._v("重置")])],1)],1)],1),a("Col",{staticClass:"P-MB-10",attrs:{span:"24"}},[a("Table",{ref:"EnableSku",attrs:{columns:e.Cols,data:e.List,size:"small",stripe:"",height:500},on:{"on-selection-change":e.GetSelected}})],1),a("Col",{attrs:{span:"24"}},[a("Page",{attrs:{current:e.Pager.PageIndex,total:e.Pager.TotalItems,"page-size":e.Pager.PageSize,"page-size-opts":e.Pager.PageOpt,"show-total":"","show-sizer":"","show-elevator":""},on:{"on-change":e.ChangePage,"on-page-size-change":e.ChangePageSize}})],1)],1),a("ShowBigPic",{ref:"ShowBigPic"}),a("footer",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.HandleAddSku()}}},[e._v("添加")]),a("Button",{on:{click:function(t){e.EnableSkuModal=!1}}},[e._v("取消")])],1)],1)},s=[],i=(a("d9b9"),a("cee1"),a("6bf8"),a("e24e")),n=a("5c62"),o=(a("b449"),a("5d83")),c=a("3231"),l=a("064d"),u=a("46d7"),h=a("631e"),S=a("4a81"),p=a("d11d"),d=a("db83"),m=function(e){Object(u["a"])(a,e);var t=Object(h["a"])(a);function a(){var e;return Object(c["a"])(this,a),e=t.apply(this,arguments),e.EnableSkuModal=!1,e.DropPlatformList=e.$Utils.GetEnumArr(e.$Enums.Sales.Platform),e.DropBrandList=[],e.DropStatus=e.$Utils.GetEnumArr(e.$Enums.Warehouse.SkuStatus),e.ComponentFrom="",e.AccurateSearch=!1,e.Pager=new d["a"].Pager,e.SearchForm=new d["a"].EnableSkuSearch,e.SearchKeyTypeDrop=e.$Utils.GetEnumArr(e.$Enums.Product.SkuSearchType),e.Selected=[],e.List=[],e.Cols=[{type:"selection",width:60,align:"center"},{title:"图片",key:"DefaultImage",width:80,align:"center",render:function(t,a){return t("div",{style:{width:"45px",height:"45px",background:"url("+e.$Server.File+"/"+a.row.DefaultImage+") no-repeat",backgroundSize:"cover",margin:"0 auto",cursor:"pointer"},on:{click:function(){e.ShowPic(a.row.DefaultImage)}}})}},{title:"SKU编号",key:"SkuCode",width:150,render:function(e,t){return e("Tooltip",{props:{content:t.row.SkuCode,maxWidth:200},class:"P-W-100-Percent"},[e("p",{class:"P-LINE-1 P-MT-5"},""===t.row.SkuCode?"-":t.row.SkuCode)])}},{title:"SKU名称",key:"SkuName",width:200,render:function(e,t){return e("Tooltip",{props:{content:t.row.SkuName,maxWidth:200},class:"P-W-100-Percent"},[e("p",{class:"P-LINE-1 P-MT-5"},""===t.row.SkuName?"-":t.row.SkuName)])}},{title:"平台",key:"Platform",width:80,render:function(t,a){return t("span",e.$Enums.Sales.Platform[a.row.Platform])}},{title:"品类",key:"CategoryName"},{title:"特性标签",key:"Attribute",width:100,render:function(e,t){return e("Tooltip",{props:{content:t.row.Attribute,maxWidth:200},class:"P-W-100-Percent"},[e("p",{class:"P-LINE-1 P-MT-5"},""===t.row.Attribute?"-":t.row.Attribute)])}},{title:"供应商",key:"SupplyName",width:100,render:function(e,t){return e("Tooltip",{props:{content:t.row.SupplyName,maxWidth:200},class:"P-W-100-Percent"},[e("p",{class:"P-LINE-1 P-MT-5"},""===t.row.SupplyName?"-":t.row.SupplyName)])}},{title:"采购价",key:"PurchasePrice",width:100,render:function(e,t){return e("span",t.row.DefaultSupply.PurchasePrice?"￥".concat(t.row.DefaultSupply.PurchasePrice):"-")}},{title:"销售主管",key:"SaleManager",width:100},{title:"申请时间",width:160,render:function(t,a){return t("span",{},e.$UI.Render.Date(a.row.CreateTime,!0))}},{title:"状态",key:"Status",width:120,render:function(t,a){return t("span",e.$Enums.Warehouse.SkuStatus[a.row.Status])}}],e}return Object(l["a"])(a,[{key:"HandleResMsg",value:function(e,t){}},{key:"Trigger",value:function(e,t){var a=this;if(this.GetPoints(),this.ComponentFrom=void 0===t?"":t,e){if("selection"===this.Cols[0].type&&this.Cols.shift(),"操作"!==this.Cols[this.Cols.length-1].title){var r={title:"操作",width:100,render:function(e,t){return e("Button",{props:{size:"small",type:"error"},on:{click:function(){if(a.Selected.push(JSON.parse(JSON.stringify(t.row))),"ModifyPurchaseApply"===a.ComponentFrom&&(4==a.Selected[0].Status||5==a.Selected[0].Status))return a.$UI.Tips.Floating("warning","选择的SKU中包含了待清或清完状态的SKU，请检查后再进行添加"),void a.CancelSelect();a.EmitSkuRes()}}},"选择")}};this.Cols.push(r)}}else if("selection"!==this.Cols[0].type){var s={type:"selection",width:60,align:"center"};this.Cols.unshift(s),this.Cols.pop()}this.List.length>0?this.CancelSelect():this.ResetList(),this.$nextTick((function(){this.$set(this,"EnableSkuModal",!0)}))}},{key:"GetPoints",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=this,e.t1=this,e.next=4,this.GetDropList(this.$Server.Purchase,this.$Api.BrandDropList,"");case 4:e.t2=e.sent,e.t0.$set.call(e.t0,e.t1,"DropBrandList",e.t2);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"GetDropList",value:function(e,t,a){var r=this;return new Promise((function(s){r.$Request.Post({Server:e,Api:{Address:t},Data:a,Callback:function(e){e.IsSuccess?s(e.Data.DropList):r.$Request.Error(e)}})}))}},{key:"GetList",value:function(){var e=this;this.CancelSelect(),this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.SkuGetEnableList,Login:!0},Data:{PageIndex:this.Pager.PageIndex,PageSize:this.Pager.PageSize,Conditions:this.SearchForm},Callback:function(t){var a;t.IsSuccess?(e.Pager.TotalItems=t.Data.PageModel.TotalItems,(a=e.List).splice.apply(a,[0,e.List.length].concat(Object(n["a"])(t.Data.PageModel.Items)))):e.$Request.Error(t);e.$UI.Loading.Hide()}})}},{key:"TriggerSearch",value:function(){this.$set(this,"AccurateSearch",!this.AccurateSearch)}},{key:"GetSelected",value:function(e){this.$set(this,"Selected",e)}},{key:"CancelSelect",value:function(){this.$refs["EnableSku"].selectAll(!1),this.$set(this,"Selected",[])}},{key:"SearchList",value:function(){this.$set(this,"AccurateSearch",!1),this.$set(this.Pager,"PageIndex",1),this.GetList()}},{key:"ResetList",value:function(){this.$set(this,"AccurateSearch",!1),this.$set(this,"Pager",new d["a"].Pager),this.$set(this,"SearchForm",new d["a"].EnableSkuSearch),this.GetList()}},{key:"ChangePage",value:function(e){this.$set(this.Pager,"PageIndex",e),this.GetList()}},{key:"ChangePageSize",value:function(e){this.$set(this.Pager,"PageSize",e),this.GetList()}},{key:"ShowPic",value:function(e){this.$refs.ShowBigPic.Trigger(e)}},{key:"HandleAddSku",value:function(){if(this.Selected.length<1)this.$UI.Tips.Floating("warning","请选择SKU");else{if("ModifyPurchaseApply"==this.ComponentFrom){var e,t=Object(i["a"])(this.Selected);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(4==a.Status||5==a.Status)return this.$UI.Tips.Floating("warning","选择的SKU中包含了待清或清完状态的SKU，请检查后再进行添加"),void this.CancelSelect()}}catch(r){t.e(r)}finally{t.f()}}this.EmitSkuRes()}}},{key:"EmitSkuRes",value:function(){this.HandleResMsg(this.Selected),this.$set(this,"List",[]),this.$set(this,"EnableSkuModal",!1),this.CancelSelect()}}]),a}(p["d"]);S["a"]([Object(p["b"])()],m.prototype,"HandleResMsg",null),m=S["a"]([Object(p["a"])({name:"EnableSku",components:{ShowBigPic:function(){return a.e("chunk-c0a1d894").then(a.bind(null,"6156"))}}})],m);var P=m,g=P,f=a("4023"),k=Object(f["a"])(g,r,s,!1,null,null,null);t["default"]=k.exports}}]);