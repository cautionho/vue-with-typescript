(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4c5ca340"],{"03e2":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"P-Inline-Block P-MR-10"},[a("Col",[a("Button",{staticClass:"P-MB-10",attrs:{type:"primary"},on:{click:function(t){return e.Trigger(0)}}},[e._v("添加作图需求")]),a("Modal",{attrs:{title:0===e.OperateForm.Id?"添加作图需求":"修改作图需求","mask-closable":!1,width:800},on:{"on-cancel":function(t){return e.ClearModal(0)}},model:{value:e.ShowModal,callback:function(t){e.ShowModal=t},expression:"ShowModal"}},[e.ShowModal?a("Form",{ref:"OperateForm",attrs:{model:e.OperateForm,rules:e.OperateFormRules,name:"OperateForm",onsubmit:"return false","label-width":110}},[a("Form-item",{attrs:{label:"SPU编号：",prop:"SpuCodes"}},[a("Button",{attrs:{type:"primary"},on:{click:e.TriggerAddSpu}},[e._v("选择SPU")])],1),a("Form-item",{staticClass:"Max-Height-200"},e._l(e.OperateForm.SpuCodes,(function(t){return a("Tag",{key:t,attrs:{type:"border",color:"default",name:t,closable:""},on:{"on-close":e.HandleCloseSpu}},[e._v(" "+e._s(t)+" ")])})),1),a("Form-item",{attrs:{label:"SPU编号："}},[a("Button",{attrs:{type:"primary"},on:{click:e.OpenSkuModal}},[e._v("选择Sku")])],1),a("Form-item",{staticClass:"Max-Height-200"},e._l(e.OperateForm.SkuCodes,(function(t){return a("Tag",{key:t,attrs:{type:"border",color:"default",name:t,closable:""},on:{"on-close":e.HandleCloseSku}},[e._v(" "+e._s(t)+" ")])})),1),a("Form-item",{attrs:{label:"美工：",prop:"OperateUserId"}},[a("Select",{attrs:{placeholder:"美工",options:e.DropOperateUserList},model:{value:e.OperateForm.OperateUserId,callback:function(t){e.$set(e.OperateForm,"OperateUserId",t)},expression:"OperateForm.OperateUserId"}})],1),a("Form-item",{attrs:{label:"期望交图时间："}},[a("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"date",placeholder:"期望交图时间"},model:{value:e.OperateForm.ExpectTime,callback:function(t){e.$set(e.OperateForm,"ExpectTime",t)},expression:"OperateForm.ExpectTime"}})],1),a("Form-item",{attrs:{label:"描述："}},[a("Input",{attrs:{type:"textarea",rows:4,placeholder:"描述"},model:{value:e.OperateForm.Description,callback:function(t){e.$set(e.OperateForm,"Description",t)},expression:"OperateForm.Description"}})],1)],1):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.SubModal(!0)}}},[e._v("提交美工处理")]),a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.SubModal(!1)}}},[e._v("提交")]),a("Button",{on:{click:function(t){return e.ClearModal(0)}}},[e._v("取消")])],1)],1),a("Modal",{attrs:{title:"选择凸显SKU","mask-closable":!1,width:"800"},on:{"on-cancel":e.CloseSkuModal},model:{value:e.ShowSkuModal,callback:function(t){e.ShowSkuModal=t},expression:"ShowSkuModal"}},[a("Row",{staticClass:"Max-Height-500"},e._l(e.MainSpu,(function(t,r){return a("Col",{key:r},[a("h3",[e._v(e._s(t.Name)+"：")]),a("CheckboxGroup",{staticClass:"P-MB-10",model:{value:e.SkuTags,callback:function(t){e.SkuTags=t},expression:"SkuTags"}},e._l(t.SkuList,(function(e,t){return a("Checkbox",{key:t,staticClass:"P-ML-10",attrs:{label:e.SkuCode}})})),1)],1)})),1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.HandleAddSku}},[e._v("添加")]),a("Button",{on:{click:e.CloseSkuModal}},[e._v("取消")])],1)],1),a("EnableSpu",{ref:"EnableSpu",on:{"handle-res-msg":e.HandleSpuRes}})],1)],1)},o=[],s=(a("d9b9"),a("02cc"),a("5e8c"),a("5d9d"),a("0a9c"),a("cee1"),a("6bf8"),a("eb83"),a("9b6f"),a("5c62")),i=a("e24e"),n=a("3231"),l=a("064d"),u=a("46d7"),c=a("631e"),p=a("4a81"),d=a("d11d"),S=a("eb49"),h=function(e){Object(u["a"])(a,e);var t=Object(c["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.SkuTags=[],e.MapCodeTags="",e.ShowModal=!1,e.ShowSkuModal=!1,e.OperateForm=new S["a"].DrawingRequirementsModify,e.OperateFormRules={SpuCodes:[{required:!0,message:"请选择SPU编号",trigger:"blur",type:"array"}],OperateUserId:[{required:!0,message:"请选择美工",trigger:"change",type:"number"}]},e.MainSpu=[],e}return Object(l["a"])(a,[{key:"HandleResMsg",value:function(e){}},{key:"Trigger",value:function(e){0===e?(this.$set(this,"OperateForm",new S["a"].DrawingRequirementsModify),this.ShowModal=!0):this.GetDetail(e)}},{key:"ClearModal",value:function(e){this.ShowModal=!1,this.$refs["OperateForm"].resetFields(),this.HandleResMsg(e)}},{key:"GetDetail",value:function(e){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.GetRequestDetail,Login:!0},Data:e,Callback:function(e){if(t.$UI.Loading.Hide(),e.IsSuccess){t.OperateForm.Id=e.Data.Data.Id;var a,r=Object(i["a"])(e.Data.Data.SpuList);try{for(r.s();!(a=r.n()).done;){var o=a.value;t.OperateForm.SpuCodes.push(o.SkuCode),t.MainSpu.push({Id:o.SkuId,Name:o.SkuCode,SkuList:[]})}}catch(u){r.e(u)}finally{r.f()}var s,n=Object(i["a"])(e.Data.Data.SkuList);try{for(n.s();!(s=n.n()).done;){var l=s.value;t.OperateForm.SkuCodes.push(l.SkuCode)}}catch(u){n.e(u)}finally{n.f()}t.OperateForm.OperateUserId=e.Data.Data.OperateUserId,t.OperateForm.ExpectTime=e.Data.Data.ExpectTime.indexOf("1900-01-01")>-1?"":e.Data.Data.ExpectTime,t.OperateForm.Description=e.Data.Data.Description,t.ShowModal=!0}else t.$Request.Error(e)}})}},{key:"TriggerAddSpu",value:function(){this.$refs["EnableSpu"].Trigger()}},{key:"HandleSpuRes",value:function(e){if(e.length>0){var t,a=Object(i["a"])(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;if(!this.OperateForm.SpuCodes.includes(r.SkuCode)){var o={Id:r.Id,Name:r.SkuCode,SkuList:[]};this.MainSpu.push(o),this.OperateForm.SpuCodes.push(r.SkuCode)}}}catch(s){a.e(s)}finally{a.f()}}}},{key:"SubModal",value:function(e){var t=this;this.$refs["OperateForm"].validate((function(a){if(a){var r=JSON.parse(JSON.stringify(t.OperateForm));if(""!==r.ExpectTime){var o=Date.parse((new Date).toString()),s=Date.parse(r.ExpectTime);if(o>s)return void t.$UI.Tips.Floating("warning","期望交图时间不能早于当前时间")}r.ExpectTime=t.$UI.Render.Date(r.ExpectTime,!0),r.IsToArtist=e,t.$UI.Loading.Show(),t.$Request.Post({Server:t.$Server.Purchase,Api:{Address:t.$Api.AddOrEditDrawing,Login:!0},Data:r,Callback:function(e){t.$UI.Loading.Hide(),e.IsSuccess?(t.$UI.Tips.Floating("success","提交作图需求成功"),t.ClearModal(1)):t.$Request.Error(e)}})}}))}},{key:"HandleCloseSpu",value:function(e,t){var a,r;(a=this.OperateForm.SpuCodes).splice.apply(a,[0,this.OperateForm.SpuCodes.length].concat(Object(s["a"])(this.OperateForm.SpuCodes.filter((function(e){return e!==t})))));var o,n=this.MainSpu.filter((function(e){return e.Name===t})),l=Object(i["a"])(n[0].SkuList);try{for(l.s();!(o=l.n()).done;)for(var u=o.value,c=0;c<this.OperateForm.SkuCodes.length;c++)u.SkuCode===this.OperateForm.SkuCodes[c]&&(this.OperateForm.SkuCodes.splice(c,1),c--)}catch(p){l.e(p)}finally{l.f()}(r=this.MainSpu).splice.apply(r,[0,this.MainSpu.length].concat(Object(s["a"])(this.MainSpu.filter((function(e){return e.Name!==t})))))}},{key:"HandleCloseSku",value:function(e,t){var a;(a=this.OperateForm.SkuCodes).splice.apply(a,[0,this.OperateForm.SkuCodes.length].concat(Object(s["a"])(this.OperateForm.SkuCodes.filter((function(e){return e!==t})))))}},{key:"OpenSkuModal",value:function(){if(0!==this.OperateForm.SpuCodes.length){var e,t=Object(i["a"])(this.MainSpu);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.SkuList.splice(0)}}catch(r){t.e(r)}finally{t.f()}this.GetSpuPropertyList()}else this.$UI.Tips.Floating("warning","请先选择SPU再选择凸显SKU")}},{key:"GetSpuPropertyList",value:function(){var e=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.SkuGetEnableList,Login:!0},Data:{PageIndex:1,PageSize:9999,SortField:"",SortOrder:"",Conditions:{SearchKey:"",Platfrom:"",Attribute:"",DevUserId:"",Purchaser:"",SaleManager:"",DevManager:"",Status:"",BrandId:"",SearchType:"",CategoryId:"",MainId:"",PropertyType:2,Spus:this.OperateForm.SpuCodes.join(",")}},Callback:function(t){if(e.$UI.Loading.Hide(),t.IsSuccess){var a,r,o=Object(i["a"])(t.Data.PageModel.Items);try{for(o.s();!(r=o.n()).done;){var n,l=r.value,u=Object(i["a"])(e.MainSpu);try{for(u.s();!(n=u.n()).done;){var c=n.value;l.MainId===c.Id&&c.SkuList.push(l)}}catch(h){u.e(h)}finally{u.f()}}}catch(h){o.e(h)}finally{o.f()}var p,d=Object(i["a"])(e.MainSpu);try{for(d.s();!(p=d.n()).done;){var S=p.value;0===S.SkuList.length&&S.SkuList.push({SkuCode:S.Name})}}catch(h){d.e(h)}finally{d.f()}(a=e.SkuTags).splice.apply(a,[0,e.SkuTags.length].concat(Object(s["a"])(e.OperateForm.SkuCodes))),e.ShowSkuModal=!0}else e.$Request.Error(t)}})}},{key:"HandleAddSku",value:function(){var e;(e=this.OperateForm.SkuCodes).splice.apply(e,[0,this.OperateForm.SkuCodes.length].concat(Object(s["a"])(this.SkuTags))),this.CloseSkuModal()}},{key:"CloseSkuModal",value:function(){this.ShowSkuModal=!1,this.SkuTags.splice(0)}}]),a}(d["d"]);p["a"]([Object(d["c"])()],h.prototype,"DropOperateUserList",void 0),p["a"]([Object(d["b"])()],h.prototype,"HandleResMsg",null),h=p["a"]([Object(d["a"])({name:"ModifyDrawingRequirements",components:{EnableSpu:function(){return a.e("chunk-2d216db6").then(a.bind(null,"c3f6"))}}})],h);var f=h,m=f,k=(a("f1f9"),a("4023")),v=Object(k["a"])(m,r,o,!1,null,null,null);t["default"]=v.exports},"5da7":function(e,t,a){},f1f9:function(e,t,a){"use strict";var r=a("5da7"),o=a.n(r);o.a}}]);