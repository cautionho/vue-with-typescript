(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12151c04"],{"1c56":function(e,t,a){},"2ea7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Row",{staticClass:"P-Inline-Block"},[a("Button",{staticClass:"P-Inline-Block P-MR-10 P-MB-10",attrs:{type:"primary"},on:{click:function(t){return e.OpenModal()}}},[e._v("添加补货需求")]),a("Modal",{attrs:{title:["添加补货需求","修改补货需求"][Number(e.CurIsModify)],"mask-closable":!1,width:1e3},on:{"on-cancel":function(t){return e.CancelModal(!1)}},model:{value:e.IsShowModal,callback:function(t){e.IsShowModal=t},expression:"IsShowModal"}},[a("Row",[a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.CurIsModify,expression:"!CurIsModify"}],attrs:{span:24}},[a("Form",{ref:"OperateForm",attrs:{model:e.OperateForm,rules:e.OperateFormRules,"label-width":120,onsubmit:"return false"}},[a("Form-item",{attrs:{label:"仓库：",prop:"WarehouseId"}},[a("Select",{attrs:{placeholder:"请选择仓库",options:e.PropWarehouseDrop},model:{value:e.OperateForm.WarehouseId,callback:function(t){e.$set(e.OperateForm,"WarehouseId",t)},expression:"OperateForm.WarehouseId"}})],1),a("Form-item",{attrs:{label:"备注：",prop:"Remark"}},[a("Input",{attrs:{autosize:{minRows:3,maxRows:3},placeholder:"请输入备注",type:"textarea"},model:{value:e.OperateForm.Remark,callback:function(t){e.$set(e.OperateForm,"Remark",t)},expression:"OperateForm.Remark"}})],1)],1)],1),a("Col",{attrs:{span:24}},[a("div",{staticClass:"P-TA-C P-P-5 THeadBorder FS_15"},[e._v("物品列表")]),a("Table",{ref:"TableList",attrs:{height:400,columns:e.ViewRowHead,data:e.TableList,size:"small",stripe:""}})],1),a("Col",{directives:[{name:"show",rawName:"v-show",value:!e.CurIsModify,expression:"!CurIsModify"}],staticClass:"P-TA-R P-MT-10",attrs:{span:24}},[a("Button",{attrs:{type:"primary"},on:{click:e.$TriggerEnableSku}},[e._v("选择SKU")])],1)],1),a("footer",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.SubModal}},[e._v(e._s(["添加","修改"][Number(e.CurIsModify)]))]),a("Button",{on:{click:function(t){return e.CancelModal(!1)}}},[e._v("取消")])],1)],1),a("EnableSku",{ref:"EnableSku",on:{"handle-res-msg":e.HandleSkuRes}})],1)},o=[],r=(a("76bb"),a("4d62"),a("6ed5"),a("cee1"),a("e8f2"),a("6bf8"),a("e24e")),i=a("3231"),n=a("064d"),l=a("46d7"),u=a("631e"),d=a("4a81"),c=a("d11d"),p=a("1f41"),h=function(e){Object(l["a"])(a,e);var t=Object(u["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.OperateForm=new p["a"].ReplenishDemandModifyForm,e.OperateFormRules={WarehouseId:[{required:!0,message:"请选择仓库",trigger:"change",type:"number"}]},e.IsShowModal=!1,e.CurIsModify=!1,e.TableList=[],e.ViewRowHead=[],e.TableRowHead=[{title:"SKU编号",key:"SkuCode",width:200},{title:"名称",key:"SkuName"},{title:"补货数量",width:200,renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red"}},"*"),e("span","补货数量")])},render:function(t,a){return t("InputNumber",{class:"P-W-100-Percent",props:{value:a.row.Num,min:1,step:1},attrs:{placeholder:"请输入数量"},on:{input:function(t){e.SetSelectedSkuNum(a.index,t)}}})}},{title:"操作",width:100,render:function(t,a){return t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.TableList.splice(a.index,1)}}},"删除")}}],e}return Object(n["a"])(a,[{key:"EmitChange",value:function(e,t){}},{key:"$Trigger",value:function(e){var t=e.IsModify,a=e.SelectedDetail;this.CurIsModify=t,this.IsShowModal=!0,this.$set(this,"ViewRowHead",this.TableRowHead.slice(0,t?-1:void 0)),t&&this.TableList.push(new p["a"].ReplenishDemandModifyTable(a.ReplenishId,a.SkuCode,a.SkuName,a.Num))}},{key:"OpenModal",value:function(){this.CurIsModify=!1,this.IsShowModal=!0,this.$set(this,"ViewRowHead",this.TableRowHead.slice(0))}},{key:"$TriggerEnableSku",value:function(){this.$refs["EnableSku"].Trigger(!1)}},{key:"HandleSkuRes",value:function(e){var t,a=this,s=Object(r["a"])(e);try{var o=function(){var e=t.value;if(a.TableList.some((function(t){return t.ReplenishId==e.Id})))return"continue";a.TableList.push(new p["a"].ReplenishDemandModifyTable(e.Id,e.SkuCode,e.SkuName))};for(s.s();!(t=s.n()).done;)o()}catch(i){s.e(i)}finally{s.f()}}},{key:"SetSelectedSkuNum",value:function(e,t){this.$set(this.TableList[e],"Num",Number(t))}},{key:"SubModal",value:function(){var e=this;this.$refs["OperateForm"].validate((function(t){if(t||e.CurIsModify){if(0==e.TableList.length)return void e.$UI.Tips.Floating("warning","请添加SKU");if(e.TableList.some((function(e){return 0==e.Num})))return void e.$UI.Tips.Floating("warning","请输入正确的补货数量");e.PostModal()}}))}},{key:"PostModal",value:function(){var e=this,t=this.CurIsModify?this.$Api.SkuReplenishEdit:this.$Api.SkuReplenishAdd,a=this.CurIsModify?new p["a"].ReplenishDemandPostModify(this.TableList[0].ReplenishId,this.TableList[0].Num):this.TableList.map((function(t){return new p["a"].ReplenishDemandPostAdd(e.OperateForm.WarehouseId,e.OperateForm.Remark,t.ReplenishId,t.Num)}));this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Warehouse,Api:{Address:t,Login:!0},Data:a,Callback:function(t){e.$UI.Loading.Hide(),t.IsSuccess?(e.$UI.Tips.Floating("success",e.CurIsModify?"修改补货需求成功":"添加补货需求成功"),e.CancelModal(!0)):e.$Request.Error(t)}})}},{key:"CancelModal",value:function(e){this.IsShowModal=!1,this.TableList.splice(0),this.$refs["OperateForm"].resetFields(),this.EmitChange(e)}}]),a}(c["d"]);d["a"]([Object(c["c"])()],h.prototype,"PropWarehouseDrop",void 0),d["a"]([Object(c["b"])()],h.prototype,"EmitChange",null),h=d["a"]([Object(c["a"])({name:"ReplenishDemandModify",components:{EnableSku:function(){return a.e("chunk-2d0dd9de").then(a.bind(null,"81c2"))}}})],h);var m=h,f=m,b=(a("3e85"),a("4023")),k=Object(b["a"])(f,s,o,!1,null,"8c507c30",null);t["default"]=k.exports},"3e85":function(e,t,a){"use strict";var s=a("1c56"),o=a.n(s);o.a}}]);