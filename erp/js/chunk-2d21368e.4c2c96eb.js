(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21368e"],{ad0e:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Row",{staticClass:"P-Inline-Block"},[i("Col",[i("Button",{staticClass:"P-Inline-Block P-MR-10",attrs:{type:"primary"},on:{click:t.OpenModal}},[t._v("批量打印SKU标签")]),i("Modal",{attrs:{title:"批量打印SKU标签","mask-closable":!1,width:1100},on:{"on-cancel":function(e){return t.ClearModal(0)}},model:{value:t.ModifyModal,callback:function(e){t.ModifyModal=e},expression:"ModifyModal"}},[i("Row",[i("Form",{ref:"PrintSkuForm",attrs:{"label-width":150,model:t.PrintSkuForm,rules:t.BatchPrintSkuRule,inline:"",onsubmit:"return false"}},[i("FormItem",{staticClass:"P-W-100-Percent P-MB-10",attrs:{label:"到货单号/采购单号：",prop:"Code"}},[i("Input",{ref:"BatchPrintSkuLabelCode",attrs:{placeholder:"到货单号/采购单号"},on:{"on-enter":t.CheckPrintSkuData},model:{value:t.PrintSkuForm.Code,callback:function(e){t.$set(t.PrintSkuForm,"Code",e)},expression:"PrintSkuForm.Code"}}),i("p",{staticClass:"Color-Gray"},[t._v("请扫描/输入到货单号或快递单号，输入完成后请按回车键。")])],1),i("FormItem",{staticClass:"P-W-100-Percent ivu-form-Item-required",attrs:{label:"选择标签大小："}},[i("Select",{staticClass:"P-W-100-Percent",attrs:{placeholder:"标签大小",options:t.DropSkuSizeList},model:{value:t.PrintSkuSize,callback:function(e){t.PrintSkuSize=e},expression:"PrintSkuSize"}})],1)],1),i("Col",[i("Table",{ref:"BatchPrintSkuTable",attrs:{columns:t.Cols,data:t.List,size:"small",stripe:"",height:400}})],1)],1),i("footer",{staticClass:"P-TA-R",attrs:{slot:"footer"},slot:"footer"},[i("Button",{attrs:{type:"primary"},on:{click:function(e){return t.PrintSku()}}},[t._v("打印")]),i("Button",{on:{click:function(e){return t.ClearModal(0)}}},[t._v("取消")])],1)],1)],1)],1)},a=[],r=(i("9660"),i("6ed5"),i("cee1"),i("e8f2"),i("b916"),i("d088"),i("0b78"),i("3231")),o=i("064d"),s=i("46d7"),l=i("631e"),u=i("4a81"),m=i("d11d"),c=i("c638"),d=i("2437"),S=function(t){Object(s["a"])(i,t);var e=Object(l["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.PrintSkuSize="60*40",t.ModifyModal=!1,t.PrintSkuForm=new c["a"].SingleCodeForm,t.BatchPrintSkuRule={Code:[{required:!0,message:" "}]},t.DropSkuSizeList=[{Key:"50*30mm",Value:"50*30"},{Key:"50*20mm",Value:"50*20"},{Key:"50*25mm",Value:"50*25"},{Key:"40*20mm",Value:"40*20"},{Key:"40*25mm",Value:"40*25"},{Key:"40*30mm",Value:"40*30"},{Key:"60*30mm",Value:"60*30"},{Key:"60*40mm",Value:"60*40"},{Key:"70*40mm",Value:"70*40"},{Key:"70*50mm",Value:"70*50"},{Key:"80*40mm",Value:"80*40"}],t.List=[],t.Cols=[{title:"到货单号",key:"PaoOrderCode"},{title:"SKU编号",key:"SkuCode"},{title:"数量",width:250,render:function(e,i){return e("InputNumber",{props:{min:0,value:t.List[i.row._index].ArrivalQuantity},className:"P-W-100-Percent",on:{"on-change":function(e){t.List[i.row._index].ArrivalQuantity=e}}})}}],t}return Object(o["a"])(i,[{key:"HandleResMsg",value:function(t){}},{key:"Trigger",value:function(){var t=this;this.ModifyModal=!0,this.$nextTick((function(){t.$refs["BatchPrintSkuLabelCode"].focus()}))}},{key:"OpenModal",value:function(){this.HandleResMsg(2)}},{key:"CheckPrintSkuData",value:function(){var t=this;this.$refs["PrintSkuForm"].validate((function(e){if(e){for(var i=0;i<t.List.length;i++)if(t.List[i].PaoOrderCode===t.PrintSkuForm.Code)return t.$UI.Tips.Floating("warning","该到货单已存在列表中"),void(t.PrintSkuForm.Code="");t.GetSkuData()}}))}},{key:"GetSkuData",value:function(){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.PrintSKU,Login:!0},Data:this.PrintSkuForm.Code,Callback:function(e){t.$UI.Loading.Hide(),e.IsSuccess?(e.Data.Data.forEach((function(i,n){t.List.some((function(t){return t.PaoOrderCode===i.PaoOrderCode}))||t.List.push(e.Data.Data[n])})),t.PrintSkuForm.Code="",t.$refs["PrintSkuForm"].resetFields()):t.$Request.Error(e)}})}},{key:"PrintSku",value:function(){if(0!==this.List.length){var t=Object(d["a"])(),e=this.PrintSkuSize.split("*"),i=document.createElement("p");i.style.textAlign="center";var n=e[0],a=e[1];Number(n),Number(a);for(var r in this.$UI.Loading.Show(),this.List){var o=this.List[r].SkuCode,s=o,l=this.List[r].SkuName,u=this.List[r].LocationCode;"0"!==r&&(t.NewPage(),t.PRINT_INITA("0mm","0mm",n+"mm",a+"mm",""),t.SET_PRINT_PAGESIZE(0,n+"mm",a+"mm",""),t.SET_PRINT_MODE("PRINT_NOCOLLATE",1),t.PRINT());for(var m=Math.ceil(this.List[r].ArrivalQuantity/40),c=1;c<=m;c++){t.PRINT_INITA("0mm","0mm",n+"mm",a+"mm",""),t.SET_PRINT_PAGESIZE(0,n+"mm",a+"mm",""),t.SET_PRINT_MODE("PRINT_NOCOLLATE",1);for(var S=this.ComputedSkuLabelAmount(c,this.List[r].ArrivalQuantity,40),P=0;P<S;P++)this.DesignSkuLabel(t,o,s,l,u);t.PRINT()}}this.$UI.Tips.Floating("success","打印SKU标签成功"),this.$UI.Loading.Hide(),this.EmptyContent()}else this.$UI.Tips.Floating("warning","请输入到货单/快递单号，按回车键")}},{key:"ComputedSkuLabelAmount",value:function(t,e,i){return t*i>e?e-(t-1)*i:i}},{key:"DesignSkuLabel",value:function(t,e,i,n,a){t.NewPage(),t.ADD_PRINT_BARCODE("4.26mm","10%","80%","13.15mm","128Auto",e),t.SET_PRINT_STYLEA(0,"ShowBarText",0),t.ADD_PRINT_TEXT("19.82mm","25.51mm","32.54mm","6.56mm",i),t.SET_PRINT_STYLEA(0,"FontName","微软雅黑"),t.SET_PRINT_STYLEA(0,"Alignment",2),t.SET_PRINT_STYLEA(0,"Bold",1),t.ADD_PRINT_TEXT("28.84mm","1.59mm","57.68mm","9.79mm",n),t.SET_PRINT_STYLEA(0,"FontName","微软雅黑"),t.SET_PRINT_STYLEA(0,"FontSize",10),t.SET_PRINT_STYLEA(0,"Alignment",2),t.SET_PRINT_STYLEA(0,"Bold",1),t.ADD_PRINT_TEXT("19.82mm","2.01mm","23.5mm","5.29mm",a),t.SET_PRINT_STYLEA(0,"FontName","微软雅黑"),t.SET_PRINT_STYLEA(0,"Bold",1)}},{key:"EmptyContent",value:function(){this.PrintSkuForm=new c["a"].SingleCodeForm,this.$refs["PrintSkuForm"].resetFields(),this.List.splice(0,this.List.length),this.PrintSkuSize="60*40",this.List.splice(0)}},{key:"ClearModal",value:function(t){this.EmptyContent(),this.ModifyModal=!1,this.HandleResMsg(t)}}]),i}(m["d"]);u["a"]([Object(m["b"])()],S.prototype,"HandleResMsg",null),S=u["a"]([Object(m["a"])({name:"PrintSkuLabel"})],S);var P=S,k=P,T=i("4023"),h=Object(T["a"])(k,n,a,!1,null,null,null);e["default"]=h.exports}}]);