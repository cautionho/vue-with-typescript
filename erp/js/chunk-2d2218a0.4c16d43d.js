(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2218a0"],{cb7b:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Col",[a("Button",{attrs:{type:"primary"},on:{click:e.Trigger}},[e._v("批量生成拣货批次")]),a("Modal",{attrs:{title:"批量生成拣货批次",width:800},on:{"on-cancel":e.CancelModal},model:{value:e.CreateBatchModal,callback:function(t){e.CreateBatchModal=t},expression:"CreateBatchModal"}},[a("Form",{ref:"CreateBatchInfo",attrs:{model:e.CreateBatchInfo,rules:e.CreateBatchRules,"label-width":100,onsubmit:"return false;"}},[a("FormItem",{attrs:{label:"平台：",prop:"PlatformId"}},[a("Select",{attrs:{placeholder:"平台",options:e.PlatformDrop,onChange:e.ChangePlatform},model:{value:e.CreateBatchInfo.PlatformId,callback:function(t){e.$set(e.CreateBatchInfo,"PlatformId",t)},expression:"CreateBatchInfo.PlatformId"}})],1),a("FormItem",{attrs:{label:"店铺：",prop:"StoreId"}},[a("Select",{ref:"StoreDrop",attrs:{placeholder:"店铺",options:e.StoreDrop},model:{value:e.CreateBatchInfo.StoreId,callback:function(t){e.$set(e.CreateBatchInfo,"StoreId",t)},expression:"CreateBatchInfo.StoreId"}})],1),a("FormItem",{attrs:{label:"国家：",prop:"CountryCode"}},[a("Select",{attrs:{placeholder:"国家",options:e.COUNTRY_DROP,optionValKey:"CountryCode",optionKey:"CountryNameCn"},model:{value:e.CreateBatchInfo.CountryCode,callback:function(t){e.$set(e.CreateBatchInfo,"CountryCode",t)},expression:"CreateBatchInfo.CountryCode"}})],1),a("FormItem",{attrs:{label:"发货仓：",prop:"ShipWarehouseId"}},[a("Select",{attrs:{placeholder:"发货仓",options:e.WarehouseDrop,onChange:e.ChangeWarehouse},model:{value:e.CreateBatchInfo.ShipWarehouseId,callback:function(t){e.$set(e.CreateBatchInfo,"ShipWarehouseId",t)},expression:"CreateBatchInfo.ShipWarehouseId"}})],1),a("FormItem",{attrs:{label:"物流渠道：",prop:"ShipMethodId"}},[a("Select",{ref:"MethodDrop",attrs:{placeholder:"物流渠道",options:e.MethodDrop,optionValKey:"Id",optionKey:"Name",multiple:""},model:{value:e.CreateBatchInfo.ShipMethodId,callback:function(t){e.$set(e.CreateBatchInfo,"ShipMethodId",t)},expression:"CreateBatchInfo.ShipMethodId"}})],1),a("FormItem",{attrs:{label:"订单类型：",prop:"ItemType"}},[a("Select",{attrs:{placeholder:"订单类型",options:e.ItemTypeDrop},model:{value:e.CreateBatchInfo.ItemType,callback:function(t){e.$set(e.CreateBatchInfo,"ItemType",t)},expression:"CreateBatchInfo.ItemType"}})],1),a("FormItem",{attrs:{label:"库区：",prop:"StorageFarm"}},[a("Select",{attrs:{placeholder:"库区",options:e.LocationDrop,multiple:""},model:{value:e.CreateBatchInfo.StorageFarm,callback:function(t){e.$set(e.CreateBatchInfo,"StorageFarm",t)},expression:"CreateBatchInfo.StorageFarm"}})],1),a("FormItem",{attrs:{label:"时间段：",prop:"TimeType"}},[a("Select",{attrs:{placeholder:"时间段",options:e.TimeTypeDrop},model:{value:e.CreateBatchInfo.TimeType,callback:function(t){e.$set(e.CreateBatchInfo,"TimeType",t)},expression:"CreateBatchInfo.TimeType"}})],1),a("FormItem",{staticClass:"P-Inline-Block P-W-49-Percent P-MR-0",attrs:{label:"",prop:"BeginTime"}},[a("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"datetime",placeholder:"开始时间"},model:{value:e.CreateBatchInfo.BeginTime,callback:function(t){e.$set(e.CreateBatchInfo,"BeginTime",t)},expression:"CreateBatchInfo.BeginTime"}})],1),a("FormItem",{staticClass:"P-Inline-Block P-W-49-Percent P-MR-0",attrs:{label:"",prop:"EndTime"}},[a("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"datetime",placeholder:"结束时间"},model:{value:e.CreateBatchInfo.EndTime,callback:function(t){e.$set(e.CreateBatchInfo,"EndTime",t)},expression:"CreateBatchInfo.EndTime"}})],1),a("FormItem",{attrs:{label:"生成规则：",prop:"OrderCount"}},[a("Input",{attrs:{placeholder:"生成规则"},model:{value:e.CreateBatchInfo.OrderCount,callback:function(t){e.$set(e.CreateBatchInfo,"OrderCount",t)},expression:"CreateBatchInfo.OrderCount"}})],1)],1),a("footer",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.Validate}},[e._v("提交")]),a("Button",{on:{click:e.CancelModal}},[e._v("取消")])],1)],1)],1)},o=[],n=(a("0a9c"),a("6ed5"),a("6bf8"),a("7623"),a("522a"),a("52af"),a("e24e")),i=a("5c62"),s=a("3231"),c=a("064d"),l=a("46d7"),h=a("631e"),p=a("4a81"),u=a("d11d"),d=a("a349"),f=a("1459"),m=function(e){Object(l["a"])(a,e);var t=Object(h["a"])(a);function a(){var e;return Object(s["a"])(this,a),e=t.apply(this,arguments),e.CreateBatchModal=!1,e.PlatformDrop=e.$Utils.GetEnumArr(e.$Enums.Sales.Platform),e.StoreDrop=[],e.ItemTypeDrop=e.$Utils.GetEnumArr(e.$Enums.Warehouse.ItemType),e.WarehouseDrop=[],e.MethodDrop=[],e.LocationDrop=e.GetLocations(),e.TimeTypeDrop=e.$Utils.GetEnumArr(e.$Enums.Warehouse.TimeType),e.CreateBatchInfo=new f["a"].CreateBatchInfo,e.CreateBatchRules={ShipWarehouseId:[{required:!0,message:"请选择发货仓",trigger:"change",type:"number"}],ShipMethodId:[{required:!0,message:"请选择物流渠道",trigger:"change",type:"array"}],ItemType:[{required:!0,message:"请选择订单类型",trigger:"change",type:"number"}],OrderCount:[{required:!0,message:"请输入生成规则"},{pattern:/^[1-9][\d]*$/,message:"请输入正确的生成规则"}]},e}return Object(c["a"])(a,[{key:"EmitOperateSuccess",value:function(){}},{key:"GetLocations",value:function(){for(var e=[],t=1;t<=15;t++)e.push({Key:t,Value:t});return e}},{key:"GetDropLists",value:function(e,t,a){var r=this;return new Promise((function(o){r.$Request.Post({Server:e,Api:{Address:t},Data:a,Callback:function(e){e.IsSuccess?o(e.Data.DropList):r.$Request.Error(e)}})}))}},{key:"GetWarehouseDrop",value:function(){var e=this;this.GetDropLists(this.$Server.Settings,this.$Api.GetWarehouseDropList,!0).then((function(t){var a;(a=e.WarehouseDrop).push.apply(a,Object(i["a"])(t))}))}},{key:"Trigger",value:function(){this.$set(this,"CreateBatchModal",!0),this.WarehouseDrop.length||this.GetWarehouseDrop()}},{key:"ChangePlatform",value:function(e){var t=this;e?this.GetDropLists(this.$Server.Sales,this.$Api.Sales[String(e)].StoreDrop,"").then((function(e){var a;(a=t.StoreDrop).push.apply(a,Object(i["a"])(e))})):(this.$set(this,"StoreDrop",[]),this.CreateBatchInfo.StoreId=0)}},{key:"ChangeWarehouse",value:function(e){var t=this;e?this.GetDropLists(this.$Server.Logistics,this.$Api.ChannelDropList,e).then((function(e){var a;(a=t.MethodDrop).push.apply(a,Object(i["a"])(e))})):(this.$set(this,"MethodDrop",[]),this.CreateBatchInfo.ShipMethodId=[])}},{key:"Validate",value:function(){var e=this;this.$refs.CreateBatchInfo.validate((function(t){if(t&&e.ValidateRules()){e.$UI.Loading.Show();var a=JSON.parse(JSON.stringify(e.CreateBatchInfo));a.BeginTime=e.$UI.Render.NewDate(a.BeginTime),a.EndTime=e.$UI.Render.NewDate(a.EndTime),a.StorageFarm=a.StorageFarm.join(","),e.$Request.Post({Server:e.$Server.Warehouse,Api:{Address:e.$Api.QuickCreateBatchOrder,Login:!0},Data:a,Callback:function(t){e.$UI.Loading.Hide(),t.IsSuccess?setTimeout((function(){e.$UI.Tips.Modal({Type:"success",Content:"批量生成拣货批次成功，共生成".concat(t.Data.Count,"个批次"),Callback:function(t){e.EmitOperateSuccess()}})}),500):e.$Request.Error(t)}})}}))}},{key:"ValidateRules",value:function(){var e=this.CreateBatchInfo.BeginTime&&!this.CreateBatchInfo.EndTime||!this.CreateBatchInfo.BeginTime&&this.CreateBatchInfo.EndTime,t=!this.CreateBatchInfo.TimeType&&this.CreateBatchInfo.BeginTime&&this.CreateBatchInfo.EndTime;if(e||t)return this.$UI.Tips.Floating("请选择时间区间"),!1;if(+new Date(this.CreateBatchInfo.BeginTime)>+new Date(this.CreateBatchInfo.EndTime))return this.$UI.Tips.Floating("开始时间不能晚于结束时间"),!1;if(this.CreateBatchInfo.OrderCount>500&&this.CreateBatchInfo.ItemType<=3)return this.$UI.Tips.Floating("warning","明细类型为单品的发货订单单次生成拣货批次不可超过500条"),!1;if(this.CreateBatchInfo.OrderCount>100&&this.CreateBatchInfo.ItemType>3)return this.$UI.Tips.Floating("warning","明细类型为多品的发货订单单次生成拣货批次不可超过100条"),!1;var a,r=[],o=Object(n["a"])(this.CreateBatchInfo.ShipMethodId);try{var i=function(){var e=a.value;[9,27,80,81,85,86,99,101,105,107,113,118,119,120,148,150,151,154,156,157,158,161,162,170,171,172,173,174,184].some((function(t){return t===e}))?r.push(15):[28,108,138,147,176,177].some((function(t){return t===e}))?r.push(20):r.push(10)};for(o.s();!(a=o.n()).done;)i()}catch(c){o.e(c)}finally{o.f()}var s=new Set(r);return!(s.size>1)||(this.$UI.Tips.Floating("warning","请选择面单大小一致的发货订单进行操作"),!1)}},{key:"CancelModal",value:function(){var e=this;this.$set(this,"CreateBatchModal",!1),this.$nextTick((function(){e.$refs.CreateBatchInfo.resetFields()}))}},{key:"COUNTRY_DROP",get:function(){return this["Base/COUNTRY_DROP"]}}]),a}(u["d"]);p["a"]([Object(u["b"])()],m.prototype,"EmitOperateSuccess",null),p["a"]([d["b"]],m.prototype,"Base/COUNTRY_DROP",void 0),m=p["a"]([Object(u["a"])({name:"QuickCreateBatch"})],m);var I=m,C=I,B=a("4023"),T=Object(B["a"])(C,r,o,!1,null,null,null);t["default"]=T.exports}}]);