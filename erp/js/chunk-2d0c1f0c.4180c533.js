(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c1f0c"],{"47d7":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"P-Inline-Block P-MR-10"},[a("Col",[a("Button",{attrs:{type:"primary"},on:{click:e.OpenModifyOrgModal}},[e._v("添加组织")]),a("Modal",{attrs:{title:0===e.OperateForm.Id?"添加组织":"编辑组织","mask-closable":!1,width:800},on:{"on-cancel":function(t){return e.ClearModal(0)}},model:{value:e.ModifyOrgModal,callback:function(t){e.ModifyOrgModal=t},expression:"ModifyOrgModal"}},[a("Form",{ref:"OperateForm",attrs:{model:e.OperateForm,rules:e.OperateFormRule,name:"OperateForm",onsubmit:"return false","label-width":110}},[a("Form-item",{attrs:{label:"组织名称：",prop:"Name"}},[a("Input",{ref:"OperateFormName",attrs:{placeholder:"组织名称",name:"UserName"},model:{value:e.OperateForm.Name,callback:function(t){e.$set(e.OperateForm,"Name",t)},expression:"OperateForm.Name"}})],1),a("Form-item",{attrs:{label:"所属组织："}},[e.ModifyOrgModal?a("Cascader",{attrs:{data:e.TreeOrganization,name:"OrganizationId",filterable:"","change-on-select":"",placeholder:"所属组织"},on:{"on-change":e.GetOrganization},model:{value:e.ModifyOrganizationId,callback:function(t){e.ModifyOrganizationId=t},expression:"ModifyOrganizationId"}}):e._e()],1),a("Form-item",{attrs:{label:"负责人："}},[a("Select",{attrs:{placeholder:"负责人",options:e.UserDropList},model:{value:e.OperateForm.PrincipalId,callback:function(t){e.$set(e.OperateForm,"PrincipalId",t)},expression:"OperateForm.PrincipalId"}})],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.SubModal}},[e._v("提交")]),a("Button",{on:{click:function(t){return e.ClearModal(0)}}},[e._v("取消")])],1)],1)],1)],1)},r=[],n=(a("d9b9"),a("76bb"),a("cee1"),a("e8f2"),a("6bf8"),a("eb83"),a("5c62")),o=a("3231"),s=a("064d"),d=a("46d7"),l=a("631e"),c=a("4a81"),p=a("d11d"),O=a("398e"),u=function(e){Object(d["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(o["a"])(this,a),e=t.apply(this,arguments),e.TreeOrganization=[],e.UserDropList=[],e.UseApi="",e.ModifyOrganizationId=[],e.ModifyOrgModal=!1,e.OperateForm=new O["a"].Organization,e.OperateFormRule={Name:[{required:!0,message:"请输入组织名称"}]},e}return Object(s["a"])(a,[{key:"HandleResMsg",value:function(e){}},{key:"Trigger",value:function(e){var t,a,i,r=e.SelectedData,o=e.TreeOrganization,s=e.CurOrganizationId,d=e.UserDropList;(s.pop(),(t=this.UserDropList).splice.apply(t,[0,this.UserDropList.length].concat(Object(n["a"])(JSON.parse(JSON.stringify(d))))),(a=this.TreeOrganization).splice.apply(a,[0,this.TreeOrganization.length].concat(Object(n["a"])(JSON.parse(JSON.stringify(o))))),this.ModifyOrganizationId.splice(0),this.$set(this,"OperateForm",r.Id>0?r:new O["a"].ModifyOrganization),this.OperateForm.Id>0)?this.FindParentIds(this.TreeOrganization,Number(this.OperateForm.Id)):(i=this.ModifyOrganizationId).push.apply(i,Object(n["a"])(s.map((function(e){return e.toString()}))));this.UseApi=0===r.Id?this.$Api.OrganizationCreate:this.$Api.OrganizationModify,this.$set(this,"ModifyOrgModal",!0),this.$nextTick((function(){this.$refs["OperateFormName"].focus()}))}},{key:"FindParentIds",value:function(e,t){for(var a in e)e[a].Id==t?0!=e[a].ParentId&&(this.ModifyOrganizationId.splice(0,0,e[a].ParentId.toString()),this.FindParentIds(this.TreeOrganization,e[a].ParentId)):this.FindParentIds(e[a].ChildNodes,t)}},{key:"OpenModifyOrgModal",value:function(){this.HandleResMsg(3)}},{key:"ClearModal",value:function(e){this.$set(this,"ModifyOrgModal",!1),this.$refs["OperateForm"].resetFields(),this.HandleResMsg(e)}},{key:"SubModal",value:function(){var e=this;this.$refs["OperateForm"].validate((function(t){if(t){e.$set(e.OperateForm,"ParentId",e.ModifyOrganizationId.length>0?Number(e.ModifyOrganizationId[e.ModifyOrganizationId.length-1]):0);var a=JSON.parse(JSON.stringify(e.OperateForm));if(a.Id===a.ParentId)return void e.$UI.Tips.Floating("warning","请选择非自身组织");e.$UI.Loading.Show(),e.$Request.Post({Server:e.$Server.Admin,Api:{Address:e.UseApi,Login:!0},Data:a,Callback:function(t){t.IsSuccess?(e.$UI.Tips.Floating("success",0===e.OperateForm.Id?"添加组织成功":"编辑组织成功"),e.ClearModal(1)):(e.$UI.Loading.Hide(),e.$Request.Error(t))}})}}))}},{key:"GetOrganization",value:function(e){this.$set(this,"ModifyOrganizationId",e)}}]),a}(p["d"]);c["a"]([Object(p["b"])()],u.prototype,"HandleResMsg",null),u=c["a"]([Object(p["a"])({name:"ModifyOrganization"})],u);var f=u,g=f,m=a("4023"),h=Object(m["a"])(g,i,r,!1,null,null,null);t["default"]=h.exports}}]);