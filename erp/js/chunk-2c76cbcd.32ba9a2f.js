(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c76cbcd"],{c5c1:function(e,t,a){"use strict";var r=a("d9ba"),i=a.n(r);i.a},d9ba:function(e,t,a){},eed4:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Row",[a("Form",{ref:"HandleForm",attrs:{model:e.HandleForm,onsubmit:"return false","label-width":100}},[a("Checkbox",{on:{"on-change":e.PostSelectNotRefund},model:{value:e.NOTRECEIVEDGOODS_INFO.IsSelectNoRefund,callback:function(t){e.$set(e.NOTRECEIVEDGOODS_INFO,"IsSelectNoRefund",t)},expression:"NOTRECEIVEDGOODS_INFO.IsSelectNoRefund"}},[e._v(" 买家升级后，系统不自动退款")]),a("FormItem",{staticClass:"P-MB-10",attrs:{label:"操作："}},[a("RadioGroup",{model:{value:e.HandleType,callback:function(t){e.HandleType=t},expression:"HandleType"}},e._l(e.HandleTypeList,(function(t,r){return a("Radio",{key:r,attrs:{label:t.Value}},[a("span",[e._v(e._s(t.Key))])])})),1)],1),2===e.HandleType?a("Col",[a("FormItem",{attrs:{label:"承运商：",rules:{required:2===e.HandleType,message:"请输入承运商"},prop:"MethodName"}},[a("Input",{attrs:{placeholder:"承运商"},model:{value:e.HandleForm.MethodName,callback:function(t){e.$set(e.HandleForm,"MethodName",t)},expression:"HandleForm.MethodName"}})],1),a("FormItem",{attrs:{label:"发货时间：",rules:{required:2===e.HandleType,message:"请选择发货时间",type:"date"},prop:"SendTime"}},[a("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"date",placeholder:"发货时间"},model:{value:e.HandleForm.SendTime,callback:function(t){e.$set(e.HandleForm,"SendTime",t)},expression:"HandleForm.SendTime"}})],1),a("FormItem",{attrs:{label:"跟踪号：",rules:{required:2===e.HandleType,message:"请输入跟踪号"},prop:"TrackingNum"}},[a("Input",{attrs:{placeholder:"跟踪号"},model:{value:e.HandleForm.TrackingNum,callback:function(t){e.$set(e.HandleForm,"TrackingNum",t)},expression:"HandleForm.TrackingNum"}})],1)],1):e._e(),5===e.HandleType?a("Col",[a("FormItem",{attrs:{label:"原因：",rules:{required:5===e.HandleType,message:"请选择原因",trigger:"change",type:"number"},prop:"TypeReason"}},[a("Select",{attrs:{placeholder:"原因",options:e.InquiryReasonList},model:{value:e.HandleForm.TypeReason,callback:function(t){e.$set(e.HandleForm,"TypeReason",t)},expression:"HandleForm.TypeReason"}})],1)],1):e._e(),4!==e.HandleType?a("Col",{attrs:{span:"24"}},[a("FormItem",{staticClass:"P-MB-10",attrs:{label:"模板类型："}},[a("Select",{attrs:{placeholder:"模板类型",onChange:e.GetTemplateListLoading,options:e.TemplateTypeDrop,optionValKey:"TemplateTypeId",optionKey:"TemplateTypeName"},model:{value:e.TplType,callback:function(t){e.TplType=t},expression:"TplType"}})],1),a("FormItem",{staticClass:"P-MB-10",attrs:{label:"模板："}},[a("div",{staticClass:"Tpl-Container"},e._l(e.TemplateList,(function(t,r){return a("a",{key:r,staticClass:"P-MR-5",on:{click:function(a){return e.RenderContent(t)}}},[e._v(e._s("("+(r+1)+") "+t.TemplateTitle))])})),0)]),a("FormItem",{attrs:{label:"消息：",rules:{required:e.HandleType<3,message:"请输入消息"},prop:"Content"}},[a("Input",{attrs:{placeholder:"消息",type:"textarea",autosize:{minRows:6,maxRows:6}},model:{value:e.HandleForm.Content,callback:function(t){e.$set(e.HandleForm,"Content",t)},expression:"HandleForm.Content"}})],1)],1):a("Col",{attrs:{span:"24"}},[a("FormItem",{staticClass:"P-MB-0"},[a("Button",{attrs:{type:"primary"},on:{click:e.TriggerAfterSalesOrder}},[e._v("添加售后单")])],1)],1)],1),a("ModifyAfterSalesOrder",{ref:"ModifyAfterSalesOrder"})],1)},i=[],s=(a("d9b9"),a("6bf8"),a("b916"),a("9bdd"),a("e24e")),n=a("3231"),o=a("064d"),l=a("46d7"),d=a("631e"),c=a("4a81"),p=a("d11d"),u=a("a349"),m=a("4606"),h=function(e){Object(l["a"])(a,e);var t=Object(d["a"])(a);function a(){var e;return Object(n["a"])(this,a),e=t.apply(this,arguments),e.TemplateTypeDrop=[],e.TemplateList=[],e.TplType=0,e.InquiryReasonList=e.$Utils.GetEnumArr(e.$Enums.CustomerService.InquiryReasonList),e.HandleTypeList=e.$Utils.GetEnumArr(e.$Enums.CustomerService.HadleNotReceivedGoodsType),e.HandleForm=new m["a"].HandleNotReceivedGoods,e.HandleType=1,e.Carrier={ShippingMethodId:0,Platform:0,ShippingCarrier:""},e}return Object(o["a"])(a,[{key:"EmitHandleSuccess",value:function(){}},{key:"EmitCancelModal",value:function(){}},{key:"WatchHandleType",value:function(e){if(this.$refs.HandleForm.resetFields(),2===e){if(this.SHIP_ORDER_INFO.Id&&(this.$set(this.HandleForm,"TrackingNum",this.SHIP_ORDER_INFO.TrackingNumber||""),this.$set(this.HandleForm,"SendTime",new Date(this.SHIP_ORDER_INFO.ShipedTime)||"")),!this.Carrier.ShippingMethodId)return void this.GetCarrier();this.$set(this.HandleForm,"MethodName",this.Carrier.ShippingCarrier)}}},{key:"mounted",value:function(){this.TemplateTypeDrop.length||this.GetTemplateTypeDrop()}},{key:"GetTemplateTypeDrop",value:function(){var e=this;this.$Request.Post({Server:this.$Server.CustomerService,Api:{Address:this.$Api.GetTemplateTypeTree,Login:!0},Data:"",Callback:function(t){t.IsSuccess?(e.$set(e,"TemplateTypeDrop",t.Data.Data),e.GetTemplateList()):e.$Request.Error(t)}})}},{key:"GetTemplateList",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$Request.Post({Server:this.$Server.CustomerService,Api:{Address:this.$Api.GetTemplateList,Login:!0},Data:{PageIndex:1,PageSize:500,Conditions:new m["a"].SearchMailTpl({TemplateTypeId:this.TplType})},Callback:function(a){t&&e.$UI.Loading.Hide(),a.IsSuccess?e.$set(e,"TemplateList",a.Data.PageModel.Items):e.$Request.Error(a)}})}},{key:"GetTemplateListLoading",value:function(){this.$UI.Loading.Show(),this.GetTemplateList(!0)}},{key:"GetCarrier",value:function(){var e=this;this.SHIP_ORDER_INFO.ShippingMethodId&&(this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Logistics,Api:{Address:this.$Api.GetCarrierList,Login:!0},Data:this.SHIP_ORDER_INFO.ShippingMethodId,Callback:function(t){if(e.$UI.Loading.Hide(),t.IsSuccess){var a,r=Object(s["a"])(t.Data.data);try{for(r.s();!(a=r.n()).done;){var i=a.value;i.Platform===e.SHIP_ORDER_INFO.Platform&&(e.$set(e,"Carrier",i),e.$set(e.HandleForm,"MethodName",e.Carrier.ShippingCarrier))}}catch(n){r.e(n)}finally{r.f()}}else e.$Request.Error(t)}}))}},{key:"RenderContent",value:function(e){var t=e.Content;if(this.SHIP_ORDER_INFO.Id){var a=this.$UI.Render.Date(this.SHIP_ORDER_INFO.ShipedTime,!0),r=this.$UI.Render.Date(this.SHIP_ORDER_INFO.PaidTime,!0);t=t.replace(/\[BuyerId\]/g,this.SHIP_ORDER_INFO.BuyerUserId),t=t.replace(/\[TrackingNumber\]/g,this.SHIP_ORDER_INFO.TrackingNumber||"[TrackingNumber]"),t=t.replace(/\[ShippingCarrier\]/g,this.SHIP_ORDER_INFO.ShippingService),t=t.replace(/\[ShipedTime\]/g,"-"===a?"[ShipedTime]":a),t=t.replace(/\[PaidTime\]/g,"-"===r?"[PaidTime]":r),t=t.replace(/\[ShipToAddress\]/g,"".concat(this.SHIP_ORDER_ADDRESS.BuyerStreet2?this.SHIP_ORDER_ADDRESS.BuyerStreet2+",":"").concat(this.SHIP_ORDER_ADDRESS.BuyerStreet1,",").concat(this.SHIP_ORDER_ADDRESS.BuyerCity,",").concat(this.SHIP_ORDER_ADDRESS.BuyerState,",").concat(this.SHIP_ORDER_ADDRESS.BuyerCountry,",").concat(this.SHIP_ORDER_ADDRESS.BuyerZipCode))}this.$set(this.HandleForm,"Content",t)}},{key:"Reset",value:function(){this.$set(this,"HandleForm",new m["a"].HandleNotReceivedGoods),this.$refs.HandleForm.resetFields(),this.$set(this,"HandleType",1),this.$set(this,"TplType","")}},{key:"Validate",value:function(){var e=this;4!==this.HandleType?this.$refs.HandleForm.validate((function(t){t&&e.PostHandle()})):this.EmitCancelModal()}},{key:"PostHandle",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.HandleForm)),a="";switch(t.NotReceiveId=this.NOTRECEIVEDGOODS_INFO.NotReceiveId,this.HandleType){case 1:delete t.TypeReason,delete t.MethodName,delete t.SendTime,delete t.TrackingNum,a=this.$Api.NRGReplyMessage;break;case 2:delete t.TypeReason,t.SendTime=this.$UI.Date.NewDate(t.SendTime),a=this.$Api.GetShipMethod;break;case 3:delete t.TypeReason,delete t.MethodName,delete t.SendTime,delete t.TrackingNum,a=this.$Api.NRGFullRefund;break;case 5:delete t.MethodName,delete t.SendTime,delete t.TrackingNum,a=this.$Api.NRGUpgradeCase;break}a&&(this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.CustomerService,Api:{Address:a,Login:!0},Data:t,Callback:function(t){t.IsSuccess?(e.$UI.Tips.Floating("success","处理成功"),e.EmitHandleSuccess()):(e.$UI.Loading.Hide(),e.$Request.Error(t))}}))}},{key:"PostSelectNotRefund",value:function(e){var t=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.CustomerService,Api:{Address:this.$Api.NRGSetSelectNoRefund,Login:!0},Data:new m["a"].HandleNotRefund(this["NOTRECEIVEDGOODS_INFO"].NotReceiveId,e),Callback:function(a){t.$UI.Loading.Hide(),a.IsSuccess?t.$UI.Tips.Floating("success",e?"取消自动退款成功":"设置自动退款成功"):t.$Request.Error(a)}})}},{key:"TriggerAfterSalesOrder",value:function(){this.SHIP_ORDER_INFO.OrderCode?this.$refs.ModifyAfterSalesOrder.TriggerCreate(this.SHIP_ORDER_INFO.OrderCode):this.$UI.Tips.Floating("warning","未关联发货订单，无法添加售后单")}},{key:"NOTRECEIVEDGOODS_INFO",get:function(){return this["CustomerService/NOTRECEIVEDGOODS_INFO"]}},{key:"SHIP_ORDER_INFO",get:function(){return this["ShipOrder/SHIP_ORDER_INFO"]}},{key:"SHIP_ORDER_ADDRESS",get:function(){return this["ShipOrder/SHIP_ORDER_ADDRESS"]}}]),a}(p["d"]);c["a"]([u["b"]],h.prototype,"CustomerService/NOTRECEIVEDGOODS_INFO",void 0),c["a"]([u["b"]],h.prototype,"ShipOrder/SHIP_ORDER_INFO",void 0),c["a"]([u["b"]],h.prototype,"ShipOrder/SHIP_ORDER_ADDRESS",void 0),c["a"]([Object(p["b"])()],h.prototype,"EmitHandleSuccess",null),c["a"]([Object(p["b"])()],h.prototype,"EmitCancelModal",null),c["a"]([Object(p["e"])("HandleType")],h.prototype,"WatchHandleType",null),h=c["a"]([Object(p["a"])({name:"HandleNotReceivedGoods",components:{ModifyAfterSalesOrder:function(){return a.e("chunk-1d9ffbc2").then(a.bind(null,"3116"))}}})],h);var S=h,R=S,T=(a("c5c1"),a("4023")),I=Object(T["a"])(R,r,i,!1,null,"312165d2",null);t["default"]=I.exports}}]);