(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0f0635"],{"9bc9":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Row",{staticClass:"P-Inline-Block"},[a("Button",{staticClass:"P-Inline-Block P-MR-10 P-MB-10",attrs:{type:"primary"},on:{click:e.ScanOpenModal}},[e._v("扫描入库")]),a("Modal",{attrs:{title:"扫描入库","mask-closable":!1,width:700},on:{"on-cancel":function(t){return e.ScanCloseModal(!1)}},model:{value:e.IsShowScanModal,callback:function(t){e.IsShowScanModal=t},expression:"IsShowScanModal"}},[a("Form",{ref:"ScanOperateForm",attrs:{model:e.ScanOperateForm,rules:e.ScanOperateFormRules,"label-width":120,onsubmit:"return false"}},[a("Form-item",{attrs:{label:"补货需求编号：",prop:"ReplenishCode"}},[a("Input",{ref:"ReplenishCode_Ipt",attrs:{disabled:e.DisabledReplenishCode,placeholder:"请输入补货需求编号"},on:{"on-enter":function(t){return e.GetPdaOutStoreDetial(!0,e.ScanOperateForm.ReplenishCode)}},model:{value:e.ScanOperateForm.ReplenishCode,callback:function(t){e.$set(e.ScanOperateForm,"ReplenishCode",t)},expression:"ScanOperateForm.ReplenishCode"}})],1),a("Form-item",{attrs:{label:"SKU编号："}},[e._v(e._s(e.ScanOperateForm.SkuCode||"-"))]),a("Form-item",{attrs:{label:"产品名："}},[e._v(e._s(e.ScanOperateForm.SkuName||"-"))]),a("Form-item",{attrs:{label:"数量："}},[e._v(e._s(e.ScanOperateForm.Num||"-"))]),a("Form-item",{attrs:{label:"发货仓货架号：",prop:"Location2"}},[a("Input",{ref:"Location2_Ipt",attrs:{disabled:e.DisabledLocation2,placeholder:"请输入发货仓货架号"},model:{value:e.ScanOperateForm.Location2,callback:function(t){e.$set(e.ScanOperateForm,"Location2",t)},expression:"ScanOperateForm.Location2"}})],1)],1),a("footer",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:e.ScanSubModal}},[e._v("入库")]),a("Button",{on:{click:function(t){return e.ScanResetModal(!1)}}},[e._v("重置")])],1)],1),a("Modal",{attrs:{title:"入库","mask-closable":!1,width:900},on:{"on-cancel":function(t){return e.CancelInStorage(!1)}},model:{value:e.IsShowInStorageModal,callback:function(t){e.IsShowInStorageModal=t},expression:"IsShowInStorageModal"}},[a("Table",{staticClass:"mt20",attrs:{columns:e.TableRowHead,data:e.TableList,stripe:""}}),a("footer",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(t){return e.PostInStorage(!1)}}},[e._v("入库")]),a("Button",{on:{click:function(t){return e.CancelInStorage(!1)}}},[e._v("取消")])],1)],1)],1)},n=[],i=(a("4d62"),a("cee1"),a("3231")),r=a("064d"),s=a("46d7"),l=a("631e"),c=a("4a81"),d=a("d11d"),u=a("1f41"),p=function(e){Object(s["a"])(a,e);var t=Object(l["a"])(a);function a(){var e;return Object(i["a"])(this,a),e=t.apply(this,arguments),e.ValidateLocation2=function(t,a,o){""===a?o(new Error("请输入发货仓货架号")):e.VerifyLocationCode.test(a)?o():o(new Error("请输入格式为“（1-15数字）-（01-999数字）-（A-Z大写字母）-（01-200数字）”的货架号"))},e.ScanOperateForm=new u["a"].PdaOutStoreDetial,e.ScanOperateFormRules={ReplenishCode:[{required:!0,message:"请输入补货需求编号",trigger:"change",type:"string"}],Location2:[{required:!0,validator:e.ValidateLocation2,trigger:"change",type:"string"}]},e.TableList=[],e.TableRowHead=[{title:"SKU编号",key:"SkuCode"},{title:"名称",key:"SkuName",render:function(e,t){return t.row.SkuName?e("Tooltip",{props:{content:t.row.SkuName,maxWidth:500},class:"P-W-100-Percent P-Tooltip-LINE-1"},t.row.SkuName):e("span","-")}},{title:"入库数量",key:"Num"},{title:"",key:"",renderHeader:function(e,t){return e("div",[e("span",{style:{color:"red"}},"*"),e("span"," 发货仓货架号")])},render:function(t,a){return t("Input",{props:{value:a.row.Location2,disabled:e.VerifyLocationCode.test(a.row.Location2)},attrs:{placeholder:"请输入货架号"},on:{"on-change":function(t){e.SetLocationCode(t,a.index)}}})}}],e.IsShowScanModal=!1,e.IsShowInStorageModal=!1,e.DisabledReplenishCode=!1,e.DisabledLocation2=!1,e.VerifyLocationCode=/^((1[0-5])|[1-9])(\-)((0[1-9])|[1-9][\d]{1,2})(\-)([A-Z])(\-)(0[1-9]|[1-9][0-9]|1[\d]{2}|200)$/,e}return Object(r["a"])(a,[{key:"EmitChange",value:function(e,t){}},{key:"$Trigger",value:function(e){var t=e.SelectedDetail;this.GetPdaOutStoreDetial(!1,t.ReplenishCode)}},{key:"FocusReplenishCode",value:function(){var e=this;this.ScanOperateForm.ReplenishCode="",this.$nextTick((function(){e.$refs["ReplenishCode_Ipt"].focus()}))}},{key:"GetPdaOutStoreDetial",value:function(e,t){var a=this;if(""!=t){if("SUP"!=t.slice(0,3))return this.$UI.Tips.Floating("warning","请输入正确的补货需求编号"),void this.FocusReplenishCode();this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Warehouse,Api:{Address:this.$Api.SkuReplenishPdaOutStore,Login:!0},Data:t,Callback:function(t){if(a.$UI.Loading.Hide(),t.IsSuccess){var o=t.Data.Data;if(e){if(2!=o.srStatus)return a.$UI.Tips.Floating("warning","请输入状态为已出库的补货需求编号"),void a.FocusReplenishCode();a.$set(a,"ScanOperateForm",o),a.DisabledReplenishCode=!0,a.VerifyLocationCode.test(o.Location2)?a.DisabledLocation2=!0:a.$UI.Tips.Floating("warning","请输入正确的发货货仓架号")}else a.IsShowInStorageModal=!0,a.TableList.push(o)}else a.$Request.Error(t)}})}else this.$UI.Tips.Floating("warning","请输入或扫描补货需求编号")}},{key:"ScanOpenModal",value:function(){this.IsShowScanModal=!0,this.FocusReplenishCode()}},{key:"ScanSubModal",value:function(){var e=this;this.$refs["ScanOperateForm"].validate((function(t){if(t)e.PostInStorage(!0);else{if(!e.ScanOperateForm.ReplenishCode)return void e.FocusReplenishCode();if(!e.ScanOperateForm.Location2)return void e.$refs["Location2_Ipt"].focus()}}))}},{key:"PostInStorage",value:function(e){var t=this;if(e){if(!this.ScanOperateForm.ReplenishId)return this.$UI.Tips.Floating("warning","请输入或扫描补货需求编号"),this.ScanResetModal(!1),void this.FocusReplenishCode()}else if(!this.VerifyLocationCode.test(this.TableList[0].Location2))return void this.$UI.Tips.Floating("warning","请输入格式为“（1-15数字）-（01-999数字）-（A-Z大写字母）-（01-200数字）”的货架号");var a=e?this.ScanOperateForm:this.TableList[0];this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Purchase,Api:{Address:this.$Api.PurchaseArrivalOrderInStorage,Login:!0},Data:new u["a"].OrderInStorage(a.ReplenishId,a.ReplenishCode,a.Num,a.Location2),Callback:function(a){t.$UI.Loading.Hide(),a.IsSuccess?(t.$UI.Tips.Floating("warning",e?"扫描入库成功":"入库成功"),e?t.ScanResetModal(!0):t.CancelInStorage(!0)):t.$Request.Error(a)}})}},{key:"ScanResetModal",value:function(e){this.DisabledReplenishCode=!1,this.DisabledLocation2=!1,this.$set(this,"ScanOperateForm",new u["a"].PdaOutStoreDetial),this.$refs["ScanOperateForm"].resetFields(),this.FocusReplenishCode(),e&&this.EmitChange(!0)}},{key:"ScanCloseModal",value:function(e){this.ScanResetModal(!1),this.IsShowScanModal=!1}},{key:"SetLocationCode",value:function(e,t){this.TableList[t].Location2=e}},{key:"CancelInStorage",value:function(e){this.IsShowInStorageModal=!1,this.TableList.splice(0),e&&this.EmitChange(!0)}}]),a}(d["d"]);c["a"]([Object(d["b"])()],p.prototype,"EmitChange",null),p=c["a"]([Object(d["a"])({name:"ScanPutStorage"})],p);var h=p,S=h,f=a("4023"),m=Object(f["a"])(S,o,n,!1,null,"c36a02ac",null);t["default"]=m.exports}}]);