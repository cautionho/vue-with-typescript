(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ae5e8"],{"0a89":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("Row",{staticClass:"P-Inline-Block"},[r("Button",{staticClass:"P-MB-10 P-MR-10 P-Inline-Block",attrs:{type:"primary"},on:{click:function(e){t.ShowModal=!0}}},[t._v("导出数据")]),r("Modal",{attrs:{title:"导出数据","mask-closable":!1,width:"600"},on:{"on-cancel":function(e){t.ShoModal=!1}},model:{value:t.ShowModal,callback:function(e){t.ShowModal=e},expression:"ShowModal"}},[r("Form",{ref:"ExportForm",attrs:{model:t.ExportForm,rules:t.Rule,"label-width":100,onsubmit:"return false;"}},[r("Row",[r("FormItem",{attrs:{label:"平台：",prop:"Platform"}},[r("Select",{attrs:{placeholder:"请选择平台",options:t.PlatformDrop,onChange:t.OnClearSelect.bind(this,"Platform")},model:{value:t.ExportForm.Platform,callback:function(e){t.$set(t.ExportForm,"Platform",e)},expression:"ExportForm.Platform"}})],1),r("FormItem",{attrs:{label:"店铺："}},[r("Select",{ref:"ExportStore",attrs:{placeholder:"请选择店铺",options:t.StoreDrop,onChange:t.OnClearSelect.bind(this,"StoreId")},model:{value:t.ExportForm.StoreId,callback:function(e){t.$set(t.ExportForm,"StoreId",e)},expression:"ExportForm.StoreId"}})],1),r("Col",{attrs:{span:"24"}},[r("FormItem",{staticClass:"ivu-form-item-required",attrs:{label:"下单时间："}},[r("Row",[r("Col",{attrs:{span:"11"}},[r("FormItem",{attrs:{prop:"BeginTime"}},[r("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"date",placeholder:"开始时间"},model:{value:t.ExportForm.BeginTime,callback:function(e){t.$set(t.ExportForm,"BeginTime",e)},expression:"ExportForm.BeginTime"}})],1)],1),r("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[t._v("-")]),r("Col",{attrs:{span:"11"}},[r("FormItem",{attrs:{prop:"EndTime"}},[r("DatePicker",{staticClass:"P-W-100-Percent",attrs:{type:"date",placeholder:"结束时间"},model:{value:t.ExportForm.EndTime,callback:function(e){t.$set(t.ExportForm,"EndTime",e)},expression:"ExportForm.EndTime"}})],1)],1)],1)],1)],1)],1)],1),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:function(e){return t.PostExport()}}},[t._v("导出")]),r("Button",{staticStyle:{"margin-left":"8px"},on:{click:t.ClearExport}},[t._v("取消")])],1)],1)],1)},a=[],i=r("3231"),n=r("064d"),s=r("46d7"),l=r("631e"),m=r("4a81"),c=r("d11d"),p=r("1b1c"),d=function(t){Object(s["a"])(r,t);var e=Object(l["a"])(r);function r(){var t;return Object(i["a"])(this,r),t=e.apply(this,arguments),t.PlatformDrop=t.$Utils.GetEnumArr(t.$Enums.Sales.Platform),t.StoreDrop=[],t.ShowModal=!1,t.ExportForm=new p["a"].SalesOrdersSearch,t.Rule={BeginTime:[{validator:t.ValidateStartDate,trigger:"change",type:"date"}],EndTime:[{validator:t.ValidateEndDate,trigger:"change",type:"date"}],Platform:[{required:!0,type:"number",message:"请选择平台",trigger:"change"}]},t}return Object(n["a"])(r,[{key:"ClearExport",value:function(){this.ShowModal=!1,this.$refs["ExportForm"].resetFields()}},{key:"ChangePlatForm",value:function(t){this.ExportForm.StoreId="",0!=this.StoreDrop.length&&this.$refs.ExportStore.clearSingleSelect(),this.StoreDrop=[],""!=t&&this.GetStoreDropList(t)}},{key:"GetStoreDropList",value:function(t){var e=this;this.$UI.Loading.Show(),this.$Request.Post({Server:this.$Server.Sales,Api:{Address:this.$Api.Sales[t].StoreDrop},Data:"",Callback:function(t){e.$UI.Loading.Hide(),t.IsSuccess?e.StoreDrop=t.Data.DropList:e.$Request.Error(t)}})}},{key:"OnClearSelect",value:function(t){void 0==this.ExportForm[t]&&this.$set(this.ExportForm,t,"")}},{key:"PostExport",value:function(){var t=this;this.$refs["ExportForm"].validate((function(e){var r=JSON.parse(JSON.stringify(t.ExportForm));r.BeginTime=t.$UI["Render"].NewDate(r.BeginTime,!0),r.EndTime=t.$UI["Render"].NewDate(r.EndTime,!0),e&&(t.$UI.Loading.Show(),t.$Request.Post({Server:t.$Server.Report,Api:{Address:t.$Api.ShipOrderSummaryOfDayExport,Login:!0},Data:r,Callback:function(e){t.$UI.Loading.Hide(),e.IsSuccess?(t.ClearExport(),t.$UI.Tips.Modal({Type:"success",Content:"创建导出订单销售报表成功。请到报表-导出管理模块查看目前正在进行的导出任务，并在导出成功后可以下载对应数据",Callback:function(t){}})):t.$Request.Error(e)}}))}))}},{key:"ValidateStartDate",value:function(t,e,r){if(""===e&&0!==this.EndTimeMs)r(new Error("开始时间和结束时间必须同时填写"));else if(""===e)r(new Error("请选择开始时间"));else{var o=(new Date).getTime();this.StartTimeMs>o?r(new Error("开始时间不得晚于当前时间")):0!=this.EndTimeMs&&this.EndTimeMs-this.StartTimeMs>26784e5?r("时间区间不能超过31天"):r()}}},{key:"ValidateEndDate",value:function(t,e,r){""===e&&0!==this.StartTimeMs?r(new Error("开始时间和结束时间必须同时填写")):""===e?r(new Error("请选择结束时间")):this.StartTimeMs>this.EndTimeMs?r(new Error("开始时间不能晚于结束时间")):0!=this.StartTimeMs&&this.EndTimeMs-this.StartTimeMs>26784e5?r(new Error("时间区间不能超过31天")):r()}},{key:"StartTimeMs",get:function(){return""!=this.ExportForm.BeginTime?new Date(this.ExportForm.BeginTime).getTime():0}},{key:"EndTimeMs",get:function(){return""!=this.ExportForm.EndTime?new Date(this.ExportForm.EndTime).getTime():0}}]),r}(c["d"]);m["a"]([Object(c["e"])("ExportForm.Platform")],d.prototype,"ChangePlatForm",null),d=m["a"]([Object(c["a"])({name:"ExportSaleOrder"})],d);var u=d,h=u,E=r("4023"),S=Object(E["a"])(h,o,a,!1,null,null,null);e["default"]=S.exports}}]);