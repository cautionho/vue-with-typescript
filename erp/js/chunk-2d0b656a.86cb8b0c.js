(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b656a"],{"1d78":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"P-Inline-Block P-MR-10"},[r("Col",[r("Button",{attrs:{type:"primary"},on:{click:e.OpenModifyModal}},[e._v("添加品类")]),r("Modal",{attrs:{title:0===e.OperateForm.Id?"添加品类":"编辑品类","mask-closable":!1,width:800},on:{"on-cancel":function(t){return e.ClearModal(0)}},model:{value:e.ShowModal,callback:function(t){e.ShowModal=t},expression:"ShowModal"}},[e.ShowModal?r("Form",{ref:"OperateForm",attrs:{model:e.OperateForm,rules:e.OperateFormRule,name:"OperateForm",onsubmit:"return false","label-width":110}},[r("Form-item",{attrs:{label:"类目编号：",prop:"CategoryCode"}},[r("Input",{ref:"OperateFormName",attrs:{placeholder:"类目编号",name:"CategoryName"},model:{value:e.OperateForm.CategoryCode,callback:function(t){e.$set(e.OperateForm,"CategoryCode",t)},expression:"OperateForm.CategoryCode"}})],1),r("Form-item",{attrs:{label:"品类名称：",prop:"CategoryName"}},[r("Input",{attrs:{placeholder:"品类名称",name:"CategoryCode"},model:{value:e.OperateForm.CategoryName,callback:function(t){e.$set(e.OperateForm,"CategoryName",t)},expression:"OperateForm.CategoryName"}})],1),r("Form-item",{attrs:{label:"所属类目："}},[r("Cascader",{attrs:{data:e.CagtegoryTree,name:"ParentId",filterable:"","change-on-select":"",placeholder:"所属类目"},on:{"on-change":e.GetCagtefory},model:{value:e.ModifyProductCagteforyId,callback:function(t){e.ModifyProductCagteforyId=t},expression:"ModifyProductCagteforyId"}})],1),r("Form-item",{attrs:{label:"采购员：",prop:"PurchaseUserId"}},[r("Select",{attrs:{placeholder:"采购员",options:e.DropPurchaserList},model:{value:e.OperateForm.PurchaseUserId,callback:function(t){e.$set(e.OperateForm,"PurchaseUserId",t)},expression:"OperateForm.PurchaseUserId"}})],1)],1):e._e(),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"primary"},on:{click:e.SubModal}},[e._v("提交")]),r("Button",{on:{click:function(t){return e.ClearModal(0)}}},[e._v("取消")])],1)],1)],1)],1)},o=[],s=(r("d9b9"),r("cee1"),r("e8f2"),r("6bf8"),r("eb83"),r("5c62")),n=(r("b449"),r("5d83")),i=r("3231"),d=r("064d"),l=r("46d7"),c=r("631e"),u=r("4a81"),p=r("d11d"),h=r("eb49"),m=function(e){Object(l["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.CagtegoryTree=[],e.DropPurchaserList=[],e.ModifyProductCagteforyId=[],e.ShowModal=!1,e.OperateForm=new h["a"].ProductCagtegoryList,e.OperateFormRule={CategoryCode:[{required:!0,message:"请输入类目编号"}],CategoryName:[{required:!0,message:"请输入品类名称"}],PurchaseUserId:[{required:!0,message:"请选择采购员",trigger:"change",type:"number"}]},e}return Object(d["a"])(r,[{key:"HandleResMsg",value:function(e){}},{key:"Trigger",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,a,o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=t.Selected,o=t.Tree,n=t.CurrTreeDomId,0!==this.DropPurchaserList.length){e.next=8;break}return e.t0=this,e.t1=this,e.next=6,this.GetDropList(this.$Server.Admin,this.$Api.GetUserDropList,"采购员");case 6:e.t2=e.sent,e.t0.$set.call(e.t0,e.t1,"DropPurchaserList",e.t2);case 8:this.$set(this,"OperateForm",a.length>0?JSON.parse(JSON.stringify(a[0])):new h["a"].ProductCagtegoryList),(r=this.CagtegoryTree).splice.apply(r,[0,this.CagtegoryTree.length].concat(Object(s["a"])(o))),a.length>0&&0!==this.OperateForm.ParentId?(this.ModifyProductCagteforyId.unshift(this.OperateForm.ParentId.toString()),this.FindParentIds(this.CagtegoryTree,Number(this.OperateForm.ParentId))):this.$set(this,"ModifyProductCagteforyId",JSON.parse(JSON.stringify(n))),this.$set(this,"ShowModal",!0),this.$nextTick((function(){this.$refs["OperateFormName"].focus()}));case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"GetDropList",value:function(e,t,r){var a=this;return new Promise((function(o){a.$Request.Post({Server:e,Api:{Address:t},Data:r,Callback:function(e){e.IsSuccess||a.$Request.Error(e),o(e.Data.DropList||[])}})}))}},{key:"FindParentIds",value:function(e,t){for(var r in e)e[r].Id==t?0!=e[r].ParentId&&(this.ModifyProductCagteforyId.unshift(e[r].ParentId.toString()),this.FindParentIds(this.CagtegoryTree,e[r].ParentId)):this.FindParentIds(e[r].ChildNodes,t)}},{key:"OpenModifyModal",value:function(){this.HandleResMsg(2)}},{key:"ClearModal",value:function(e){this.$set(this,"ShowModal",!1),this.$refs["OperateForm"].resetFields(),this.HandleResMsg(e)}},{key:"SubModal",value:function(){var e=this;this.$refs["OperateForm"].validate((function(t){if(t){var r=JSON.parse(JSON.stringify(e.ModifyProductCagteforyId));e.$set(e.OperateForm,"ParentId",r.length>0?Number(r.pop()):0),e.$UI.Loading.Show(),e.$Request.Post({Server:e.$Server.Purchase,Api:{Address:0===e.OperateForm.Id?e.$Api.CategoryCreate:e.$Api.CategoryModify,Login:!0},Data:e.OperateForm,Callback:function(t){t.IsSuccess?(e.$UI.Tips.Floating("success",0===e.OperateForm.Id?"添加品类成功":"编辑品类成功"),e.ClearModal(1)):e.$Request.Error(t)}})}}))}},{key:"GetCagtefory",value:function(e){this.$set(this.OperateForm,"ModifyProductCagteforyId",e)}}]),r}(p["d"]);u["a"]([Object(p["b"])()],m.prototype,"HandleResMsg",null),m=u["a"]([Object(p["a"])({name:"ModifyProductCagtegory"})],m);var f=m,g=f,y=r("4023"),C=Object(y["a"])(g,a,o,!1,null,null,null);t["default"]=C.exports}}]);