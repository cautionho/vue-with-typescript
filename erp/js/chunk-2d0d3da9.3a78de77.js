(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3da9"],{"5f13":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Row",{staticClass:"P-Inline-Block"},[n("Button",{staticClass:"P-Inline-Block P-MR-10",attrs:{type:"primary"},on:{click:function(e){return t.TriggerModal(void 0)}}},[t._v("盘点")]),n("Modal",{attrs:{title:"盘点","mask-closable":!1,width:700},on:{"on-cancel":function(e){return t.InventoryRes(!1)}},model:{value:t.InventoryModal,callback:function(e){t.InventoryModal=e},expression:"InventoryModal"}},[n("Form",{ref:"InventoryForm",attrs:{model:t.InventoryForm,rules:t.InventoryRules,"label-width":85,inline:"",onsubmit:"return false"}},[n("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"仓库：",prop:"WarehouseId"}},[t.IsDisabled?n("span",[t._v(t._s(t.InventoryForm.WarehouseId?t.WarehouseList.filter((function(e){return e.Value===t.InventoryForm.WarehouseId}))[0].Key:""))]):n("Select",{attrs:{placeholder:"请选择仓库",options:t.WarehouseList},model:{value:t.InventoryForm.WarehouseId,callback:function(e){t.$set(t.InventoryForm,"WarehouseId",e)},expression:"InventoryForm.WarehouseId"}})],1),n("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"SKU编号：",prop:"SkuCode"}},[t.IsDisabled?n("span",[t._v(t._s(t.InventoryForm.SkuCode))]):n("Input",{ref:"SkuCode",attrs:{placeholder:"请输入/扫描SKU编号"},on:{"on-enter":t.CheckGetSkuInventory},model:{value:t.InventoryForm.SkuCode,callback:function(e){t.$set(t.InventoryForm,"SkuCode","string"===typeof e?e.trim():e)},expression:"InventoryForm.SkuCode"}})],1),n("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"产品名：",prop:"SkuName"}},[n("span",[t._v(t._s(t.InventoryForm.SkuName))])]),n("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"货架号：",prop:"LocationCode"}},[n("span",[t._v(t._s(t.InventoryForm.LocationCode))])]),n("Form-item",{staticClass:"P-W-49-Percent",attrs:{label:"待发数：",prop:"WaitingShipedQuantity"}},[n("span",[t._v(t._s(t.InventoryForm.WaitingShipedQuantity))])]),n("Form-item",{staticClass:"P-W-49-Percent",attrs:{label:"待拣数：",prop:"WaitPickQuantity"}},[n("span",[t._v(t._s(t.InventoryForm.WaitPickQuantity))])]),n("Form-item",{staticClass:"P-W-49-Percent",attrs:{label:"可用数：",prop:"Quantity"}},[n("span",[t._v(t._s(t.InventoryForm.Quantity))])]),n("Form-item",{staticClass:"P-W-49-Percent",attrs:{label:"原架上数：",prop:"OriQuantity"}},[n("p",[t._v(t._s(t.InventoryForm.OriQuantity))])]),n("Form-item",{staticClass:"P-W-100-Percent",attrs:{label:"现架上数：",prop:"NowQuantity"}},[n("Input",{ref:"NowQuantity",attrs:{readonly:""==t.InventoryForm.Id,placeholder:"请输入当前SKU现架上数"},on:{"on-enter":t.CheckInventoryMsg},model:{value:t.InventoryForm.NowQuantity,callback:function(e){t.$set(t.InventoryForm,"NowQuantity",e)},expression:"InventoryForm.NowQuantity"}})],1),n("Form-item",{attrs:{label:""}},[n("p",{staticClass:"P-Text-Info"},[t._v("原架上数 = 可用数 + 待拣数")])])],1),n("footer",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"primary"},on:{click:t.CheckInventoryMsg}},[t._v("盘点")]),n("Button",{on:{click:function(e){return t.InventoryRes(!1)}}},[t._v("取消")])],1)],1)],1)},r=[],s=(n("5d9d"),n("03d8"),n("4d62"),n("6bf8"),n("eb83"),n("3231")),a=n("064d"),i=n("46d7"),u=n("631e"),y=n("4a81"),I=n("d11d"),v=n("1f41"),l=function(t){Object(i["a"])(n,t);var e=Object(u["a"])(n);function n(){var t;return Object(s["a"])(this,n),t=e.apply(this,arguments),t.IsDisabled=!1,t.InventoryModal=!1,t.InventoryForm=new v["a"].InventoryForm,t.IsSplit=0,t.IsInventory=!1,t.InventoryRules={WarehouseId:[{required:!0,message:"请选择仓库",trigger:"change",type:"number"}],SkuCode:[{required:!0,message:"请输入/扫描SKU编号"}],NowQuantity:[{required:!0,message:"请输入当前SKU现架上数"},{pattern:/^[\d]{1,}$/,trigger:"change",message:"请输入正确的数量"}]},t}return Object(a["a"])(n,[{key:"ChangeModal",value:function(t){}},{key:"WatchGetSku",value:function(t){t&&(""!=this.InventoryForm.SkuCode?this.CheckGetSkuInventory():this.FocusSkuCode(!1))}},{key:"InventoryRes",value:function(t){var e=this;(this.IsInventory||t)&&this.ChangeModal(!0),this.InventoryModal=!1,this.IsInventory=!1,this.$refs["InventoryForm"].resetFields(),this.$nextTick((function(){e.InventoryForm.Id=""}))}},{key:"TriggerModal",value:function(t){this.InventoryModal=!0,void 0!==t?(this.$set(this.InventoryForm,"WarehouseId",t.WarehouseId),this.$set(this.InventoryForm,"SkuCode",t.SkuCode),this.$set(this,"IsDisabled",!0),this.GetSkuInventory()):this.FocusSkuCode(!0)}},{key:"FocusSkuCode",value:function(t){var e=this;t&&(this.InventoryForm.SkuCode=""),this.$nextTick((function(){e.$refs["SkuCode"].focus()}))}},{key:"FocusQuantity",value:function(t){var e=this;t&&(this.InventoryForm.NowQuantity=""),this.$nextTick((function(){e.$refs["NowQuantity"].focus()}))}},{key:"CheckGetSkuInventory",value:function(){var t=this;this.$refs["InventoryForm"].validateField("WarehouseId",(function(e){""==e&&t.$refs["InventoryForm"].validateField("SkuCode",(function(e){""==e&&t.GetSkuInventory()}))}))}},{key:"GetSkuInventory",value:function(){var t=this;this.$UI.Loading.Show(),this.IsSplit++;var e=new v["a"].SkuInventory;e["SkuCode"]=this.InventoryForm.SkuCode,e["WarehouseId"]=this.InventoryForm.WarehouseId,e["SkuId"]=0,this.$Request.Post({Server:this.$Server.Warehouse,Api:{Address:this.$Api.InventoryGetSkuInventory,Login:!0},Data:e,Callback:function(e){e.IsSuccess?t.RenderSkuInventory(e.Data.Data):t.IsSplit%2==1&&-1!=t.InventoryForm.SkuCode.indexOf("-")?(t.InventoryForm.SkuCode=t.InventoryForm.SkuCode.slice(0,t.InventoryForm.SkuCode.lastIndexOf("-")),t.GetSkuInventory()):(t.$UI.Loading.Hide(),t.IsSplit=0,t.FocusSkuCode(!0),t.$Request.Error(e)),t.$UI.Loading.Hide()}})}},{key:"RenderSkuInventory",value:function(t){this.InventoryForm.Id=t.Id,this.InventoryForm.SkuName=t.SkuName,this.InventoryForm.LocationCode=t.LocationCode,this.InventoryForm.WaitingShipedQuantity=t.WaitingShipedQuantity,this.InventoryForm.WaitPickQuantity=t.WaitPickQuantity,this.InventoryForm.Quantity=t.Quantity,this.InventoryForm.OriQuantity=t.Quantity+t.WaitPickQuantity,this.InventoryForm.NowQuantity=(t.Quantity+t.WaitPickQuantity).toString(),this.IsSplit=0,this.FocusQuantity(!1),this.$UI.Loading.Hide()}},{key:"CheckInventoryMsg",value:function(){var t=this;this.$refs["InventoryForm"].validate((function(e){e&&t.PostInventory()}))}},{key:"PostInventory",value:function(){var t=this;this.$UI.Loading.Show();var e=new v["a"].PostCheckOut;e.InventoryId=this.InventoryForm.Id,e.Quantity=parseInt(this.InventoryForm.NowQuantity),this.$Request.Post({Server:this.$Server.Warehouse,Api:{Address:this.$Api.PDACheckOut,Login:!0},Data:e,Callback:function(e){e.IsSuccess?t.IsDisabled?t.InventoryRes(!0):t.RenderSkuInventory(e.Data.Data):t.IsSplit%2==1&&-1!=t.InventoryForm.SkuCode.indexOf("-")?(t.InventoryForm.SkuCode=t.InventoryForm.SkuCode.slice(0,t.InventoryForm.SkuCode.lastIndexOf("-")),t.GetSkuInventory()):(t.$UI.Tips.Floating("success","盘点成功"),t.IsInventory=!0,t.FocusSkuCode(!0),t.$nextTick((function(){var e=JSON.parse(JSON.stringify(t.InventoryForm.WarehouseId));t.$refs["InventoryForm"].resetFields(),t.InventoryForm=new v["a"].InventoryForm,t.InventoryForm.WarehouseId=e}))),t.$UI.Loading.Hide()}})}}]),n}(I["d"]);y["a"]([Object(I["c"])()],l.prototype,"WarehouseList",void 0),y["a"]([Object(I["b"])()],l.prototype,"ChangeModal",null),y["a"]([Object(I["e"])("InventoryForm.WarehouseId")],l.prototype,"WatchGetSku",null),l=y["a"]([Object(I["a"])({name:"InventorySku"})],l);var c=l,d=c,h=n("4023"),m=Object(h["a"])(d,o,r,!1,null,null,null);e["default"]=m.exports}}]);